import h from"../general.js";async function N(f,x,v){var E;try{E=await f}catch{R.ended=!0,DocumentFragment.prototype.replaceChildren.apply(v.templateSkeleton.content,F);return}if(E?.results===void 0||E.results.length===0){R.ended=!0,DocumentFragment.prototype.replaceChildren.apply(v.templateSkeleton.content,F);return}var b;for(var z of E.results)b=h.Item.createDOMItem(z,x,v.templateItem?.content?.firstElementChild),R.fragment.appendChild(b);DocumentFragment.prototype.replaceChildren.apply(v.templateSkeleton.content,F),v.view.appendChild(R.fragment),v.buttonMore.setAttribute("data-display","1")}var R={fragment:document.createDocumentFragment(),maxPages:0,page:3,ended:!1},F=Array(6);window.addEventListener("DOMContentLoaded",function(){var f={templateSkeleton:document.getElementById("template_skeleton"),templateItem:document.getElementById("template_item"),templateModal:document.getElementById("template_modal"),headerPNav:document.getElementById("header_p_nav"),headerSearch:document.getElementById("header_search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(f.templateSkeleton===null)throw Error("DOM.templateSkeleton is null");if(f.templateItem===null)throw Error("DOM.templateItem is null");if(f.templateModal===null)throw Error("DOM.templateModal is null");if(f.headerPNav===null)throw Error("DOM.headerPNav is null");if(f.headerSearch===null)throw Error("DOM.headerSearch is null");if(f.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(f.main===null)throw Error("DOM.main is null");if(f.view===null)throw Error("DOM.view is null");if(f.buttonMore===null)throw Error("DOM.buttonMore is null");if(f.modal===null)throw Error("DOM.modal is null");h.Route.url.href=window.location.href;var x=h.Route.url,v=x.searchParams.get(h.Route.Q_TITLE),E=x.searchParams.get(h.Route.Q_MEDIA_TYPE),b=x.searchParams.get(h.Route.Q_GENRE),z=x.searchParams.get(h.Route.Q_CREW),B=x.searchParams.get(h.Route.Q_CAST),C=x.searchParams.get(h.Route.Q_COMPANY);if(E===null){window.open("./404.html","_self","noopener,noreferrer");return}if(v!==null)f.main.firstElementChild.textContent=v;var H,J;if(b!==null)H=h.API.getDiscover(E,"1",b,void 0,void 0,void 0),J=h.API.getDiscover(E,"2",b,void 0,void 0,void 0),h.Route.hrefq=`${h.Route.href}?${h.Route.Q_TITLE}=${v}&${h.Route.Q_GENRE}=${b}&`;else if(B!==null)H=h.API.getDiscover(E,"1",void 0,B,void 0,void 0),J=h.API.getDiscover(E,"2",void 0,B,void 0,void 0),h.Route.hrefq=`${h.Route.href}?${h.Route.Q_TITLE}=${v}&${h.Route.Q_CAST}=${B}&`;else if(z!==null)H=h.API.getDiscover(E,"1",void 0,void 0,z,void 0),J=h.API.getDiscover(E,"2",void 0,void 0,z,void 0),h.Route.hrefq=`${h.Route.href}?${h.Route.Q_TITLE}=${v}&${h.Route.Q_CREW}=${z}&`;else if(C!==null)H=h.API.getDiscover(E,"1",void 0,void 0,void 0,C),J=h.API.getDiscover(E,"2",void 0,void 0,void 0,C),h.Route.hrefq=`${h.Route.href}?${h.Route.Q_TITLE}=${v}&${h.Route.Q_COMPANY}=${C}&`;else{window.open("./404.html","_self","noopener,noreferrer");return}F[0]=f.view.children[0],F[1]=f.view.children[1],F[2]=f.view.children[2],F[3]=f.view.children[3],F[4]=f.view.children[4],F[5]=f.view.children[5],h.Theme.init(),h.Route.href=`${h.Route.hrefq}${h.Route.Q_MEDIA_TYPE}=${E}`,h.Route.init(f),window.addEventListener("popstate",function(){h.Route.onpopstate(f)}),f.headerButtonTheme.setAttribute("data-type",h.Theme.current),f.headerButtonTheme.addEventListener("click",h.Theme.onclick),f.headerPNav.firstElementChild.addEventListener("click",h.Nav.buttonNavOnclick),f.headerPNav.lastElementChild.addEventListener("focusout",h.Nav.navOnfocusout),f.headerSearch.children[1].addEventListener("click",function(Q){f.headerSearch.reset()}),f.buttonMore.addEventListener("click",function(){if(f.buttonMore?.setAttribute("data-display","0"),R.ended)return;f.view.appendChild(f.templateSkeleton.content);var Q;if(b!==null)Q=h.API.getDiscover(E,String(R.page),b,void 0,void 0,void 0);else if(B!==null)Q=h.API.getDiscover(E,String(R.page),void 0,B,void 0,void 0);else if(z!==null)Q=h.API.getDiscover(E,String(R.page),void 0,void 0,z,void 0);else if(C!==null)Q=h.API.getDiscover(E,String(R.page),void 0,void 0,void 0,C);N(Q,E,f),R.page+=1}),f.view.addEventListener("click",function(Q){var A=Q.target,K=A.getAttribute("data-type");if(K===h.TYPE.ITEM){Q.preventDefault();var L=A.getAttribute("data-id");if(L!==null)h.Modal.open(E,L,f,!0)}}),f.modal.addEventListener("click",function(Q){h.Modal.onclick(Q.target,f)}),f.modal.addEventListener("change",function(Q){h.Modal.onchange(Q.target,f)}),H.then(function(Q){if(Q?.results===void 0||Q.results.length===0)R.ended=!0,f.main.children[1].setAttribute("data-display","1");else{var A;for(var K of Q.results)A=h.Item.createDOMItem(K,E,f.templateItem?.content?.firstElementChild),R.fragment.appendChild(A)}DocumentFragment.prototype.replaceChildren.apply(f.templateSkeleton.content,F),f.view.appendChild(R.fragment),H=null}),J.then(function(Q){if(Q?.results===void 0||Q.results.length===0){R.ended=!0;return}var A;for(var K of Q.results)A=h.Item.createDOMItem(K,E,f.templateItem?.content?.firstElementChild),R.fragment.appendChild(A);f.view.appendChild(R.fragment),f.buttonMore?.setAttribute("data-display","1"),J=null})});
