import e from"../general.js";async function g(t,o,l){var n;try{n=await t}catch{d.ended=!0,DocumentFragment.prototype.replaceChildren.apply(l.templateSkeleton.content,i);return}if(n?.results===void 0||n.results.length===0){d.ended=!0,DocumentFragment.prototype.replaceChildren.apply(l.templateSkeleton.content,i);return}var a;for(var u of n.results)a=e.Item.createDOMItem(u,o,l.templateItem?.content?.firstElementChild),d.fragment.appendChild(a);DocumentFragment.prototype.replaceChildren.apply(l.templateSkeleton.content,i),l.view.appendChild(d.fragment),l.buttonMore.setAttribute("data-display","1")}var d={fragment:document.createDocumentFragment(),maxPages:0,page:3,ended:!1},i=Array(6);window.addEventListener("DOMContentLoaded",function(){var t={templateSkeleton:document.getElementById("template_skeleton"),templateItem:document.getElementById("template_item"),templateModal:document.getElementById("template_modal"),headerPNav:document.getElementById("header_p_nav"),headerSearch:document.getElementById("header_search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(t.templateSkeleton===null)throw Error("DOM.templateSkeleton is null");if(t.templateItem===null)throw Error("DOM.templateItem is null");if(t.templateModal===null)throw Error("DOM.templateModal is null");if(t.headerPNav===null)throw Error("DOM.headerPNav is null");if(t.headerSearch===null)throw Error("DOM.headerSearch is null");if(t.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(t.main===null)throw Error("DOM.main is null");if(t.view===null)throw Error("DOM.view is null");if(t.buttonMore===null)throw Error("DOM.buttonMore is null");if(t.modal===null)throw Error("DOM.modal is null");e.Route.url.href=window.location.href;var o=e.Route.url,l=o.searchParams.get(e.Route.Q_TITLE),n=o.searchParams.get(e.Route.Q_MEDIA_TYPE),a=o.searchParams.get(e.Route.Q_GENRE),u=o.searchParams.get(e.Route.Q_CREW),f=o.searchParams.get(e.Route.Q_CAST),c=o.searchParams.get(e.Route.Q_COMPANY);if(n===null){window.open("./404.html","_self","noopener,noreferrer");return}if(l!==null)t.main.firstElementChild.textContent=l;var s,h;if(a!==null)s=e.API.getDiscover(n,"1",a,void 0,void 0,void 0),h=e.API.getDiscover(n,"2",a,void 0,void 0,void 0),e.Route.hrefq=`${e.Route.href}?${e.Route.Q_TITLE}=${l}&${e.Route.Q_GENRE}=${a}&`;else if(f!==null)s=e.API.getDiscover(n,"1",void 0,f,void 0,void 0),h=e.API.getDiscover(n,"2",void 0,f,void 0,void 0),e.Route.hrefq=`${e.Route.href}?${e.Route.Q_TITLE}=${l}&${e.Route.Q_CAST}=${f}&`;else if(u!==null)s=e.API.getDiscover(n,"1",void 0,void 0,u,void 0),h=e.API.getDiscover(n,"2",void 0,void 0,u,void 0),e.Route.hrefq=`${e.Route.href}?${e.Route.Q_TITLE}=${l}&${e.Route.Q_CREW}=${u}&`;else if(c!==null)s=e.API.getDiscover(n,"1",void 0,void 0,void 0,c),h=e.API.getDiscover(n,"2",void 0,void 0,void 0,c),e.Route.hrefq=`${e.Route.href}?${e.Route.Q_TITLE}=${l}&${e.Route.Q_COMPANY}=${c}&`;else{window.open("./404.html","_self","noopener,noreferrer");return}i[0]=t.view.children[0],i[1]=t.view.children[1],i[2]=t.view.children[2],i[3]=t.view.children[3],i[4]=t.view.children[4],i[5]=t.view.children[5],e.Theme.init(),e.Route.href=`${e.Route.hrefq}${e.Route.Q_MEDIA_TYPE}=${n}`,e.Route.init(t),window.addEventListener("popstate",function(){e.Route.onpopstate(t)}),t.headerButtonTheme.setAttribute("data-type",e.Theme.current),t.headerButtonTheme.addEventListener("click",e.Theme.onclick),t.headerPNav.firstElementChild.addEventListener("click",e.Nav.buttonNavOnclick),t.headerPNav.lastElementChild.addEventListener("focusout",e.Nav.navOnfocusout),t.headerSearch.children[1].addEventListener("click",function(r){t.headerSearch.reset()}),t.buttonMore.addEventListener("click",function(){if(t.buttonMore?.setAttribute("data-display","0"),d.ended)return;t.view.appendChild(t.templateSkeleton.content);var r;if(a!==null)r=e.API.getDiscover(n,String(d.page),a,void 0,void 0,void 0);else if(f!==null)r=e.API.getDiscover(n,String(d.page),void 0,f,void 0,void 0);else if(u!==null)r=e.API.getDiscover(n,String(d.page),void 0,void 0,u,void 0);else if(c!==null)r=e.API.getDiscover(n,String(d.page),void 0,void 0,void 0,c);g(r,n,t),d.page+=1}),t.view.addEventListener("click",function(r){var m=r.target,p=m.getAttribute("data-type");if(p===e.TYPE.ITEM){r.preventDefault();var v=m.getAttribute("data-id");if(v!==null)e.Modal.open(n,v,t,!0)}}),t.modal.addEventListener("click",function(r){e.Modal.onclick(r.target,t)}),t.modal.addEventListener("change",function(r){e.Modal.onchange(r.target,t)}),s.then(function(r){if(r?.results===void 0||r.results.length===0)d.ended=!0,t.main.children[1].setAttribute("data-display","1");else{var m;for(var p of r.results)m=e.Item.createDOMItem(p,n,t.templateItem?.content?.firstElementChild),d.fragment.appendChild(m)}DocumentFragment.prototype.replaceChildren.apply(t.templateSkeleton.content,i),t.view.appendChild(d.fragment),s=null}),h.then(function(r){if(r?.results===void 0||r.results.length===0){d.ended=!0;return}var m;for(var p of r.results)m=e.Item.createDOMItem(p,n,t.templateItem?.content?.firstElementChild),d.fragment.appendChild(m);t.view.appendChild(d.fragment),t.buttonMore?.setAttribute("data-display","1"),h=null})});
