import c from"../general.js";async function A(u,r,f){var E;try{E=await u}catch{b.ended=!0,DocumentFragment.prototype.replaceChildren.apply(f.templateSkeleton.content,w);return}if(E?.results===void 0||E.results.length===0){b.ended=!0,DocumentFragment.prototype.replaceChildren.apply(f.templateSkeleton.content,w);return}var g;for(var v of E.results)g=c.Item.createDOMItem(v,r,f.templateItem?.content?.firstElementChild),b.fragment.appendChild(g);DocumentFragment.prototype.replaceChildren.apply(f.templateSkeleton.content,w),f.view.appendChild(b.fragment),f.buttonMore.setAttribute("data-display","1")}var b={fragment:document.createDocumentFragment(),maxPages:0,page:1,ended:!1},w=Array(6);window.addEventListener("DOMContentLoaded",function(){var u={templateSkeleton:document.getElementById("template_skeleton"),templateItem:document.getElementById("template_item"),templateModal:document.getElementById("template_modal"),headerPNav:document.getElementById("header_p_nav"),headerSearch:document.getElementById("header_search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(u.templateSkeleton===null)throw Error("DOM.templateSkeleton is null");if(u.templateItem===null)throw Error("DOM.templateItem is null");if(u.templateModal===null)throw Error("DOM.templateModal is null");if(u.headerPNav===null)throw Error("DOM.headerPNav is null");if(u.headerSearch===null)throw Error("DOM.headerSearch is null");if(u.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(u.main===null)throw Error("DOM.main is null");if(u.view===null)throw Error("DOM.view is null");if(u.buttonMore===null)throw Error("DOM.buttonMore is null");if(u.modal===null)throw Error("DOM.modal is null");c.Route.url.href=window.location.href;var r=c.Route.url,f=r.searchParams.get(c.Route.Q_MEDIA_TYPE);if(f==="tv")u.main.firstElementChild.textContent+=" Tv Series";else if(f==="movie")u.main.firstElementChild.textContent+=" Movies";else throw Error("Bad Route");w[0]=u.view.children[0],w[1]=u.view.children[1],w[2]=u.view.children[2],w[3]=u.view.children[3],w[4]=u.view.children[4],w[5]=u.view.children[5],c.Theme.init(),c.Route.href=`${c.Route.href}?${c.Route.Q_MEDIA_TYPE}=${f}`,c.Route.init(u),window.addEventListener("popstate",function(){c.Route.onpopstate(u)}),u.headerButtonTheme.setAttribute("data-type",c.Theme.current),u.headerButtonTheme.addEventListener("click",c.Theme.onclick),u.headerPNav.firstElementChild.addEventListener("click",c.Nav.buttonNavOnclick),u.headerPNav.lastElementChild.addEventListener("focusout",c.Nav.navOnfocusout),u.headerSearch.children[1].addEventListener("click",function(v){u.headerSearch.reset()}),u.buttonMore.addEventListener("click",function(v){if(u.buttonMore?.setAttribute("data-display","0"),b.ended)return;u.view.appendChild(u.templateSkeleton.content),A(c.API.getTopRated(f,String(b.page)),f,u),b.page+=1}),u.view.addEventListener("click",function(v){var x=v.target,h=x.getAttribute("data-type");if(h===c.TYPE.ITEM){v.preventDefault();var z=x.getAttribute("data-id");if(z!==null)c.Modal.open(f,z,u,!0)}}),u.modal.addEventListener("click",function(v){c.Modal.onclick(v.target,u)}),u.modal.addEventListener("change",function(v){c.Modal.onchange(v.target,u)});var E=c.API.getTopRated(f,String(b.page));b.page+=1;var g=c.API.getTopRated(f,String(b.page));b.page+=1,E.then(function(v){if(v?.results===void 0||v.results.length===0)b.ended=!0,u.main.children[1].setAttribute("data-display","1");else{var x;for(var h of v.results)x=c.Item.createDOMItem(h,f,u.templateItem?.content?.firstElementChild),b.fragment.appendChild(x)}DocumentFragment.prototype.replaceChildren.apply(u.templateSkeleton.content,w),u.view.appendChild(b.fragment),E=null}),g.then(function(v){if(v?.results===void 0||v.results.length===0){b.ended=!0;return}var x;for(var h of v.results)x=c.Item.createDOMItem(h,f,u.templateItem?.content?.firstElementChild),b.fragment.appendChild(x);u.view.appendChild(b.fragment),u.buttonMore?.setAttribute("data-display","1"),g=null})});
