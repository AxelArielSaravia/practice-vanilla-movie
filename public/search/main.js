import f from"../general.js";async function F(u,b){var N;try{N=await u}catch{E.ended=!0,DocumentFragment.prototype.replaceChildren.apply(b.templateSkeleton.content,R);return}if(N?.results===void 0||N.results.length===0){E.ended=!0,DocumentFragment.prototype.replaceChildren.apply(b.templateSkeleton.content,R);return}var v="",z;for(var A of N.results)if(v=A.media_type,v==="movie"||v==="tv")z=f.Item.createDOMItem(A,v,b.templateItem?.content?.firstElementChild),E.fragment.appendChild(z);DocumentFragment.prototype.replaceChildren.apply(b.templateSkeleton.content,R),b.view.appendChild(E.fragment),b.buttonMore.setAttribute("data-display","1")}var E={fragment:document.createDocumentFragment(),maxPages:0,page:3,ended:!1},R=Array(6);window.addEventListener("DOMContentLoaded",function(){var u={templateSkeleton:document.getElementById("template_skeleton"),templateItem:document.getElementById("template_item"),templateModal:document.getElementById("template_modal"),headerPNav:document.getElementById("header_p_nav"),headerSearch:document.getElementById("header_search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(u.templateSkeleton===null)throw Error("DOM.templateSkeleton is null");if(u.templateItem===null)throw Error("DOM.templateItem is null");if(u.templateModal===null)throw Error("DOM.templateModal is null");if(u.headerPNav===null)throw Error("DOM.headerPNav is null");if(u.headerSearch===null)throw Error("DOM.headerSearch is null");if(u.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(u.main===null)throw Error("DOM.main is null");if(u.view===null)throw Error("DOM.view is null");if(u.buttonMore===null)throw Error("DOM.buttonMore is null");if(u.modal===null)throw Error("DOM.modal is null");f.Route.url.href=window.location.href;var b=f.Route.url,N=b.searchParams.get(f.Route.Q_SEARCH);if(N!==null)u.main.firstElementChild.textContent+=` ${N}`;else{window.open("./404.html","_self","noopener,noreferrer");return}R[0]=u.view.children[0],R[1]=u.view.children[1],R[2]=u.view.children[2],R[3]=u.view.children[3],R[4]=u.view.children[4],R[5]=u.view.children[5],f.Theme.init(),f.Route.href=`${f.Route.href}?${f.Route.Q_SEARCH}=${N}`,f.Route.hrefq=`${f.Route.href}&`,f.Route.init(u),window.addEventListener("popstate",function(){f.Route.onpopstate(u)}),u.headerButtonTheme.setAttribute("data-type",f.Theme.current),u.headerButtonTheme.addEventListener("click",f.Theme.onclick),u.headerPNav.firstElementChild.addEventListener("click",f.Nav.buttonNavOnclick),u.headerPNav.lastElementChild.addEventListener("focusout",f.Nav.navOnfocusout),u.headerSearch.children[1].addEventListener("click",function(A){u.headerSearch.reset()}),u.buttonMore.addEventListener("click",function(){if(u.buttonMore?.setAttribute("data-display","0"),E.ended)return;u.view.appendChild(u.templateSkeleton.content),F(f.API.getSearch(N,String(E.page)),u),E.page+=1}),u.view.addEventListener("click",function(A){var C=A.target,w=C.getAttribute("data-type");if(w===f.TYPE.ITEM){A.preventDefault();var x=C.getAttribute("data-media"),B=C.getAttribute("data-id");if(B!==null)f.Modal.open(x,B,u,!0)}}),u.modal.addEventListener("click",function(A){f.Modal.onclick(A.target,u)}),u.modal.addEventListener("change",function(A){f.Modal.onchange(A.target,u)});var v=f.API.getSearch(N,"1"),z=f.API.getSearch(N,"2");v.then(function(A){if(A?.results===void 0||A.results.length===0)E.ended=!0,u.main.children[1].setAttribute("data-display","1");else{var C="",w;for(var x of A.results)if(C=x.media_type,C==="movie"||C==="tv")w=f.Item.createDOMItem(x,C,u.templateItem?.content?.firstElementChild),E.fragment.appendChild(w)}DocumentFragment.prototype.replaceChildren.apply(u.templateSkeleton.content,R),u.view.appendChild(E.fragment),v=null}),z.then(function(A){if(A?.results===void 0||A.results.length===0){E.ended=!0;return}var C="",w;for(var x of A.results)if(C=x.media_type,C==="movie"||C==="tv")w=f.Item.createDOMItem(x,C,u.templateItem?.content?.firstElementChild),E.fragment.appendChild(w);u.view.appendChild(E.fragment),u.buttonMore?.setAttribute("data-display","1"),z=null})});
