import v from"../general.js";async function z(u,b,c){var E;try{E=await u}catch{w.ended=!0,DocumentFragment.prototype.replaceChildren.apply(c.templateSkeleton.content,h);return}if(E?.results===void 0||E.results.length===0){w.ended=!0,DocumentFragment.prototype.replaceChildren.apply(c.templateSkeleton.content,h);return}var F;for(var f of E.results)F=v.Item.createDOMItem(f,b,c.templateItem?.content?.firstElementChild),w.fragment.appendChild(F);DocumentFragment.prototype.replaceChildren.apply(c.templateSkeleton.content,h),c.view.appendChild(w.fragment),c.buttonMore.setAttribute("data-display","1")}var w={fragment:document.createDocumentFragment(),maxPages:0,page:1,ended:!1},h=Array(6);window.addEventListener("DOMContentLoaded",function(){var u={templateSkeleton:document.getElementById("template_skeleton"),templateItem:document.getElementById("template_item"),templateModal:document.getElementById("template_modal"),headerPNav:document.getElementById("header_p_nav"),headerButtonSearch:document.getElementById("header_button-search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(u.templateSkeleton===null)throw Error("DOM.templateSkeleton is null");if(u.templateItem===null)throw Error("DOM.templateItem is null");if(u.templateModal===null)throw Error("DOM.templateModal is null");if(u.headerPNav===null)throw Error("DOM.headerPNav is null");if(u.headerButtonSearch===null)throw Error("DOM.headerButtonSearch is null");if(u.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(u.main===null)throw Error("DOM.main is null");if(u.view===null)throw Error("DOM.view is null");if(u.buttonMore===null)throw Error("DOM.buttonMore is null");if(u.modal===null)throw Error("DOM.modal is null");v.Route.url.href=window.location.href;var b=v.Route.url,c=b.searchParams.get(v.Route.Q_MEDIA_TYPE);if(c==="tv")u.main.firstElementChild.textContent+=" Tv Series";else if(c==="movie")u.main.firstElementChild.textContent+=" Movies";else if(c!=="all")throw Error("Bad Route");h[0]=u.view.children[0],h[1]=u.view.children[1],h[2]=u.view.children[2],h[3]=u.view.children[3],h[4]=u.view.children[4],h[5]=u.view.children[5],v.Theme.init(),v.Route.href=`${v.Route.href}?${v.Route.Q_MEDIA_TYPE}=${c}`,v.Route.init(u),window.addEventListener("popstate",function(){v.Route.onpopstate(u)}),u.headerButtonTheme.setAttribute("data-type",v.Theme.current),u.headerButtonTheme.addEventListener("click",v.Theme.onclick),u.headerPNav.firstElementChild.addEventListener("click",v.Nav.buttonNavOnclick),u.headerPNav.lastElementChild.addEventListener("focusout",v.Nav.navOnfocusout),u.buttonMore.addEventListener("click",function(f){if(u.buttonMore?.setAttribute("data-display","0"),w.ended)return;u.view.appendChild(u.templateSkeleton.content),z(v.API.getTrending(c,String(w.page)),c,u),w.page+=1}),u.view.addEventListener("click",function(f){var B=f.target,N=B.getAttribute("data-type");if(N===v.TYPE.ITEM){f.preventDefault();var x=B.getAttribute("data-id");if(x!==null)v.Modal.open(c,x,u,!0)}}),u.modal.addEventListener("click",function(f){v.Modal.onclick(f.target,u)}),u.modal.addEventListener("change",function(f){v.Modal.onchange(f.target,u)});var E=v.API.getTrending(c,String(w.page));w.page+=1;var F=v.API.getTrending(c,String(w.page));w.page+=1,E.then(function(f){if(f?.results===void 0||f.results.length===0){w.ended=!0,u.main.children[1].setAttribute("data-display","1");return}var B;for(var N of f.results)B=v.Item.createDOMItem(N,c,u.templateItem?.content?.firstElementChild),w.fragment.appendChild(B);DocumentFragment.prototype.replaceChildren.apply(u.templateSkeleton.content,h),u.view.appendChild(w.fragment),E=null}),F.then(function(f){if(f?.results===void 0||f.results.length===0){w.ended=!0;return}var B;for(var N of f.results)B=v.Item.createDOMItem(N,c,u.templateItem?.content?.firstElementChild),w.fragment.appendChild(B);u.view.appendChild(w.fragment),u.buttonMore?.setAttribute("data-display","1"),F=null})});
