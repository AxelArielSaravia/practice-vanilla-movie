import f from"../general.js";async function B(c,x,u){var R;try{R=await c}catch{v.ended=!0,DocumentFragment.prototype.replaceChildren.apply(u.templateSkeleton.content,E);return}if(R?.results===void 0||R.results.length===0){v.ended=!0,DocumentFragment.prototype.replaceChildren.apply(u.templateSkeleton.content,E);return}var b;for(var h of R.results)b=f.Item.createDOMItem(h,x,u.templateItem?.content?.firstElementChild),v.fragment.appendChild(b);DocumentFragment.prototype.replaceChildren.apply(u.templateSkeleton.content,E),u.view.appendChild(v.fragment),u.buttonMore.setAttribute("data-display","1")}var v={fragment:document.createDocumentFragment(),maxPages:0,page:1,ended:!1},E=Array(6);window.addEventListener("DOMContentLoaded",function(){var c={templateSkeleton:document.getElementById("template_skeleton"),templateItem:document.getElementById("template_item"),templateModal:document.getElementById("template_modal"),headerPNav:document.getElementById("header_p_nav"),headerSearch:document.getElementById("header_search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(c.templateSkeleton===null)throw Error("DOM.templateSkeleton is null");if(c.templateItem===null)throw Error("DOM.templateItem is null");if(c.templateModal===null)throw Error("DOM.templateModal is null");if(c.headerPNav===null)throw Error("DOM.headerPNav is null");if(c.headerSearch===null)throw Error("DOM.headerSearch is null");if(c.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(c.main===null)throw Error("DOM.main is null");if(c.view===null)throw Error("DOM.view is null");if(c.buttonMore===null)throw Error("DOM.buttonMore is null");if(c.modal===null)throw Error("DOM.modal is null");f.Route.url.href=window.location.href;var x=f.Route.url,u=x.searchParams.get(f.Route.Q_MEDIA_TYPE);if(u==="tv")c.main.firstElementChild.textContent+=" Tv Series";else if(u==="movie")c.main.firstElementChild.textContent+=" Movies";else if(u!=="all")throw Error("Bad Route");E[0]=c.view.children[0],E[1]=c.view.children[1],E[2]=c.view.children[2],E[3]=c.view.children[3],E[4]=c.view.children[4],E[5]=c.view.children[5],f.Theme.init(),f.Route.href=`${f.Route.href}?${f.Route.Q_MEDIA_TYPE}=${u}`,f.Route.init(c),window.addEventListener("popstate",function(){f.Route.onpopstate(c)}),c.headerButtonTheme.setAttribute("data-type",f.Theme.current),c.headerButtonTheme.addEventListener("click",f.Theme.onclick),c.headerPNav.firstElementChild.addEventListener("click",f.Nav.buttonNavOnclick),c.headerPNav.lastElementChild.addEventListener("focusout",f.Nav.navOnfocusout),c.headerSearch.children[1].addEventListener("click",function(h){c.headerSearch.reset()}),c.buttonMore.addEventListener("click",function(h){if(c.buttonMore?.setAttribute("data-display","0"),v.ended)return;c.view.appendChild(c.templateSkeleton.content),B(f.API.getTrending(u,String(v.page)),u,c),v.page+=1}),c.view.addEventListener("click",function(h){var F=h.target,w=F.getAttribute("data-type");if(w===f.TYPE.ITEM){h.preventDefault();var z=F.getAttribute("data-id"),A=F.getAttribute("data-media");if(z!==null&&A!==null)f.Modal.open(A,z,c,!0)}}),c.modal.addEventListener("click",function(h){f.Modal.onclick(h.target,c)}),c.modal.addEventListener("change",function(h){f.Modal.onchange(h.target,c)});var R=f.API.getTrending(u,String(v.page));v.page+=1;var b=f.API.getTrending(u,String(v.page));v.page+=1,R.then(function(h){if(h?.results===void 0||h.results.length===0)v.ended=!0,c.main.children[1].setAttribute("data-display","1");else{var F;for(var w of h.results)F=f.Item.createDOMItem(w,u,c.templateItem?.content?.firstElementChild),v.fragment.appendChild(F)}DocumentFragment.prototype.replaceChildren.apply(c.templateSkeleton.content,E),c.view.appendChild(v.fragment),R=null}),b.then(function(h){if(h?.results===void 0||h.results.length===0){v.ended=!0;return}var F;for(var w of h.results)F=f.Item.createDOMItem(w,u,c.templateItem?.content?.firstElementChild),v.fragment.appendChild(F);c.view.appendChild(v.fragment),c.buttonMore?.setAttribute("data-display","1"),b=null})});
