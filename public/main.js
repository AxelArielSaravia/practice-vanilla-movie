var f=function(U){if(U.ok)return U.json()};var S={getTrending(U="1"){return fetch(`${window.location.origin}/api/trending?page=${U}`).then(f)},getPopular(U,K="1"){return fetch(`${window.location.origin}/api/popular?type=${U}&page=${K}`).then(f)},getDiscover(U,K,$="1"){var F=`${window.location.origin}/api/discover?type=${U}&page=${$}`;if(K!==void 0)F=`${F}&genre=${K}`;return fetch(F).then(f)},getImages(U,K){return fetch(`${window.location.origin}/api/images?type=${K}&id=${U}`).then(f)},getGenres(U){return fetch(`${window.location.origin}/api/genres?type=${U}`).then(f)},getTopRated(U,K="1"){return fetch(`${window.location.origin}/api/toprated?type=${U}&page=${K}`).then(f)}},Y=S;var y=function(U){return Math.floor(Math.random()*U)},H=function(U){var K=U.length;for(var $=0;$<K-1;$+=1){var F=$+Math.floor(Math.random()*(K-$)),Q=U[$];U[$]=U[F],U[F]=Q}};async function T(U,K,$,F){var Q=await U;if(Q===void 0||Q.backdrops===void 0||Q.backdrops.length===0)if(F!==null&&F.length>0){var _=K.lastElementChild;_.setAttribute("src",`https://image.tmdb.org/t/p/w400${F}`),_.setAttribute("data-display","1")}else{K.firstElementChild.setAttribute("data-display","1");var q=$.content.firstElementChild?.cloneNode(!0);K.appendChild(q)}else{var z=Q.backdrops[0],_=K.lastElementChild;_.setAttribute("src",`https://image.tmdb.org/t/p/w400${z.file_path}`),_.setAttribute("data-display","1")}}var R=function(U,K,$,F,Q,_){var q=F.content.cloneNode(!0),z=q.firstElementChild,E=z.children[0];E.insertAdjacentText("beforeend",U);for(var u of K){const X=Q.content.cloneNode(!0).firstElementChild;X.setAttribute("data-id",u.id);let w,x;if($!==void 0)x=$;else x=u.media_type;if(x==="movie")w=u.title;else w=u.name;X.setAttribute("title",w),X.firstElementChild.insertAdjacentText("beforeend",w),X.lastElementChild.setAttribute("alt",w),T(Y.getImages(u.id,x),X,_,u.backdrop_path),z.lastElementChild.appendChild(X)}return z};async function N(U,K,$,F,Q,_){var q=await U;if(console.info(K,q),q?.results===void 0||q.results.length===0)throw Error("API.getTopRated does not have data");var z=R(K,q.results,$,_.templateCollection,_.templateCollItem,_.templateIcons),E=_.view.children[Q+F];E.insertAdjacentElement("beforebegin",z),E.remove()}var A={NAV_LINK:"0",COLL_TITLE:"4",COLL_BUTTON:"5"},J={MAX:15,STEPS:5,len:0,count:7,itv:0,tvGenres:null,imov:0,movieGenres:null},P={pointerFine:window.matchMedia("(pointer: fine)")},W={current:"dark",DARK:"dark",LIGHT:"light",init(){var U=localStorage.getItem("theme");if(U==="dark"||U==="light")W.current=U;else{if(window.matchMedia!==void 0&&window.matchMedia("(prefers-color-scheme: dark)").matches)W.current=W.DARK;else W.current=W.LIGHT;localStorage.setItem("theme",W.current)}document.firstElementChild?.setAttribute("class",W.current)},change(U){localStorage.setItem("theme",U),document.firstElementChild?.setAttribute("class",W.current)},onclick(U){var K=U.currentTarget;if(K===null)return;if(W.current===W.DARK)W.current=W.LIGHT;else W.current=W.DARK;K.setAttribute("data-type",W.current),W.change(W.current)}},Z={ATTR_SHOW:"data-mbshow",ATTR_SELECTED:"data-selected",ATTR_LINK_TYPE:"data-linkt",HIDDEN:"0",SHOW:"1",buttonNavOnclick(U){console.info(U);var K=U.currentTarget,$=K.nextElementSibling;if($.getAttribute(Z.ATTR_SHOW)===Z.HIDDEN)$.setAttribute(Z.ATTR_SHOW,Z.SHOW),$.firstElementChild.firstElementChild.focus();else $.setAttribute(Z.ATTR_SHOW,Z.HIDDEN)},navOnfocusout(U){var K=U.relatedTarget;if(K===null||K.getAttribute("data-type")!==A.NAV_LINK){var $=U.currentTarget;$.setAttribute(Z.ATTR_SHOW,Z.HIDDEN)}},navOnclick(U){var K=U.target;if(K.getAttribute("data-type")===A.NAV_LINK){var $=K.getAttribute(Z.ATTR_LINK_TYPE),F=U.currentTarget,Q=F.previousElementSibling;Q.replaceChildren(),Q.insertAdjacentText("beforeend",K.textContent),F.setAttribute(Z.ATTR_SHOW,Z.HIDDEN),F.setAttribute(Z.ATTR_SELECTED,$),U.preventDefault()}}},L={select(U){return U[y(U.length)]},selectHero(U){if(U){if(!U.results||U.results.length===0)throw Error("trending.results does not have data");return L.select(U.results)}},async getHeroLogo(U){if(U===void 0)return;var{id:K,media_type:$}=U,F=await Y.getImages(K,$);if(F.logos.length>0)return F.logos[0].file_path;else return},initDOMImgLogo(U,K){var $=K.lastElementChild.firstElementChild;if(U)$.lastElementChild.setAttribute("data-display","1"),$.lastElementChild.setAttribute("src",`https://image.tmdb.org/t/p/w300${U}`);else $.firstElementChild.setAttribute("data-display","1")},initDOM(U,K){var $=K.firstElementChild.firstElementChild,F=K.lastElementChild,Q=F.firstElementChild.firstElementChild,_=F.children[2];$.setAttribute("data-display","1"),$.setAttribute("src",`https://image.tmdb.org/t/p/w1280${U.backdrop_path}`),Q.textContent=U.title,_.textContent=U.overview}},B={TYPE_SBUTTON:"data-sbuttont",onclick(U){var K=U.target;if(K?.getAttribute("data-type")===A.COLL_BUTTON){var $=K.parentElement.lastElementChild;const _=K.parentElement.children[1],q=K.parentElement.children[2];var F=K.getAttribute(B.TYPE_SBUTTON),Q=$.clientWidth-$.clientWidth*6/100;if($.scrollLeft-Q<=0)_.setAttribute("data-display","0");else _.setAttribute("data-display","1");if(F==="0"){if($.scrollBy(-Q,0),$.scrollLeft-Q<=0)_.setAttribute("data-display","0");q.setAttribute("data-display","1")}else{if($.scrollBy(Q,0),$.scrollLeft+Q>=$.scrollWidth-$.clientWidth)q.setAttribute("data-display","0");_.setAttribute("data-display","1")}}}};window.addEventListener("DOMContentLoaded",function(){var U={templateCollection:document.getElementById("template_collection"),templateCollSkeleton:document.getElementById("template_collection-skeleton"),templateCollItem:document.getElementById("template_collection-item"),templateIcons:document.getElementById("template_icons"),headerButtonNav:document.getElementById("header_button-nav"),headerNav:document.getElementById("header_nav"),headerButtonSearch:document.getElementById("header_button-search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),hero:document.getElementById("hero"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more")};if(U.templateCollection===null)throw Error("DOM.templateCollection is null");if(U.templateCollSkeleton===null)throw Error("DOM.templateCollSkeleton is null");if(U.templateCollItem===null)throw Error("DOM.templateCollItem is null");if(U.templateIcons===null)throw Error("DOM.templateIcons is null");if(U.headerButtonNav===null)throw Error("DOM.headerButtonNav is null");if(U.headerNav===null)throw Error("DOM.headerNav is null");if(U.headerButtonSearch===null)throw Error("DOM.headerButtonSearch is null");if(U.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(U.main===null)throw Error("DOM.main is null");if(U.hero===null)throw Error("DOM.hero is null");if(U.view===null)throw Error("DOM.view is null");if(U.buttonMore===null)throw Error("DOM.buttonMore is null");if(W.init(),U.headerButtonTheme.setAttribute("data-type",W.current),U.headerButtonTheme.addEventListener("click",W.onclick),U.headerButtonNav.addEventListener("click",Z.buttonNavOnclick),U.headerNav.addEventListener("focusout",Z.navOnfocusout),U.headerNav.addEventListener("click",Z.navOnclick),P.pointerFine.matches)U.view.onclick=B.onclick;P.pointerFine.onchange=function(_){if(_.matches)U.view.onclick=B.onclick;else U.view.onclick=null};var K=Y.getTrending("1");K.then(function(_){console.info("trending: ",_)});var $=K.then(L.selectHero);$.then(function(_){console.info("hero: ",_)}),$.then(L.getHeroLogo).then(function(_){if(_!==void 0)L.initDOMImgLogo(_,U.hero)}),$.then(function(_){if(_!==void 0)L.initDOM(_,U.hero)}),K.then(function(_){if(_?.results===void 0||_.results.length===0)throw Error("API.getTrending does not have data");var q=R("Week Trendings",_.results,void 0,U.templateCollection,U.templateCollItem,U.templateIcons),z=U.view.children[0];z.insertAdjacentElement("beforebegin",q),z.remove()}),Y.getPopular("movie","1").then(function(_){if(console.info("getPopular movie",_),_?.results===void 0||_.results.length===0)throw Error("API.getDiscover does not have data");var q=R("Popular Movies",_.results,"movie",U.templateCollection,U.templateCollItem,U.templateIcons),z=U.view.children[1];z.insertAdjacentElement("beforebegin",q),z.remove()}),Y.getPopular("tv","1").then(function(_){if(console.info("getPopular tv",_),_?.results===void 0||_.results.length===0)throw Error("API.getDiscover does not have data");var q=R("Popular Tv series",_.results,"tv",U.templateCollection,U.templateCollItem,U.templateIcons),z=U.view.children[2];z.insertAdjacentElement("beforebegin",q),z.remove()}),Y.getTopRated("movie","1").then(function(_){if(console.info("getTopRate movie",_),_?.results===void 0||_.results.length===0)throw Error("API.getTopRated does not have data");var q=R("Top rated movie",_.results,"movie",U.templateCollection,U.templateCollItem,U.templateIcons),z=U.view.children[3];z.insertAdjacentElement("beforebegin",q),z.remove()}),Y.getTopRated("tv","1").then(function(_){if(console.info("getTopRate tv",_),_?.results===void 0||_.results.length===0)throw Error("API.getTopRated does not have data");var q=R("Top rated tv serie",_.results,"tv",U.templateCollection,U.templateCollItem,U.templateIcons),z=U.view.children[4];z.insertAdjacentElement("beforebegin",q),z.remove()});var F=Y.getGenres("movie"),Q=Y.getGenres("tv");Promise.all([F,Q]).then(function(_){if(console.info("movie genres",_[0]),console.info("tv genres",_[1]),_[0]===void 0||_[0].genres===void 0||_[0].genres.length===0)throw Error("API.getGenre does not have data");if(_[1]===void 0||_[1].genres===void 0||_[1].genres.length===0)throw Error("API.getGenre does not have data");var q=_[0].genres,z=_[1].genres;if(J.tvGenres=z,J.movieGenres=q,q.length+z.length<J.MAX)J.len=q.length+z.length;else J.len=J.MAX;if(console.info(J),U.buttonMore?.setAttribute("data-display","1"),q.length>1)H(q);if(z.length>1)H(z);var E,u,X,w,x=0,V=0;for(let j=0;j<2;j+=1){if(Math.random()<0.5)u=q[x].id,X=q[x].name,E="movie",w=`${X} Movies`,x+=1,J.imov+=1;else u=z[V].id,X=z[V].name,E="tv",w=`${X} Tv series`,V+=1,J.itv+=1;N(Y.getDiscover(E,u,"1"),w,E,j,5,U)}}),U.buttonMore.addEventListener("click",function(_){var q,z,E,u,X=J.movieGenres,w=J.tvGenres,x=J.itv,V=J.imov,j=0;U.buttonMore?.setAttribute("data-display","0");var k=0,G=!1;if(J.count+J.STEPS<J.len)k=J.count+J.STEPS;else k=J.len,G=!0;for(var b=J.count;b<k;b+=1){var C=U.templateCollSkeleton.content.cloneNode(!0);U.view?.appendChild(C)}for(var b=J.count;b<k;b+=1){if(x<w.length&&V<X.length){if(Math.random()<0.5)j=1}else if(tv<w.length)j=1;if(j===0)z=X[V].id,E=X[V].name,q="movie",u=`${E} Tv series`,V+=1,J.imov+=1;else z=w[x].id,E=w[x].name,q="tv",u=`${E} Movies`,x+=1,J.itv+=1;J.count+=1,N(Y.getDiscover(q,z,"1"),u,q,b,U.view.children.length-k,U)}if(!G)U.buttonMore?.setAttribute("data-display","1")})});
