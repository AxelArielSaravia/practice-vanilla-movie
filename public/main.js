var u=function(K){if(K.ok)return K.json()};var P={getTrending(K="1"){return fetch(`${window.location.origin}/api/trending?page=${K}`).then(u)},getPopular(K,$="1"){return fetch(`${window.location.origin}/api/popular?type=${K}&page=${$}`).then(u)},getDiscover(K,$,q="1"){var F=`${window.location.origin}/api/discover?type=${K}&page=${q}`;if($!==void 0)F=`${F}&genre=${$}`;return fetch(F).then(u)},getImages(K,$){return fetch(`${window.location.origin}/api/images?type=${$}&id=${K}`).then(u)},getGenres(K){return fetch(`${window.location.origin}/api/genres?type=${K}`).then(u)},getTopRated(K,$="1"){return fetch(`${window.location.origin}/api/toprated?type=${K}&page=${$}`).then(u)},get(K,$){return fetch(`${window.location.origin}/api/${K}?id=${$}`).then(u)}},Y=P;var G=function(K){return Math.floor(Math.random()*K)},B=function(K){var $=K.length;for(var q=0;q<$-1;q+=1){var F=q+Math.floor(Math.random()*($-q)),Q=K[q];K[q]=K[F],K[F]=Q}};async function C(K,$,q,F,Q,_){var x=await K;if(console.info($,x),x?.results===void 0||x.results.length===0)throw Error("API.getTopRated does not have data");var z=f.createDOMCollection($,x.results,q,_.templateCollection,_.templateCollItem,_.templateIcons),J=_.view.children[Q+F];J.insertAdjacentElement("beforebegin",z),J.remove()}var H={NAV_LINK:"0",COLL_TITLE:"4",COLL_BUTTON:"5",COLL_ITEM:"6",MODAL:"8",MODAL_CLOSE:"9"},U={MAX:15,STEPS:5,len:0,count:7,itv:0,tvGenres:null,imov:0,movieGenres:null},W={current:"dark",DARK:"dark",LIGHT:"light",init(){var K=localStorage.getItem("theme");if(K==="dark"||K==="light")W.current=K;else{if(window.matchMedia!==void 0&&window.matchMedia("(prefers-color-scheme: dark)").matches)W.current=W.DARK;else W.current=W.LIGHT;localStorage.setItem("theme",W.current)}document.firstElementChild?.setAttribute("class",W.current)},change(K){localStorage.setItem("theme",K),document.firstElementChild?.setAttribute("class",W.current)},onclick(K){var $=K.currentTarget;if($===null)return;if(W.current===W.DARK)W.current=W.LIGHT;else W.current=W.DARK;$.setAttribute("data-type",W.current),W.change(W.current)}},b={ATTR_SHOW:"data-mbshow",ATTR_SELECTED:"data-selected",ATTR_LINK_TYPE:"data-linkt",HIDDEN:"0",SHOW:"1",buttonNavOnclick(K){console.info(K);var $=K.currentTarget,q=$.nextElementSibling;if(q.getAttribute(b.ATTR_SHOW)===b.HIDDEN)q.setAttribute(b.ATTR_SHOW,b.SHOW),q.firstElementChild.firstElementChild.focus();else q.setAttribute(b.ATTR_SHOW,b.HIDDEN)},navOnfocusout(K){var $=K.relatedTarget;if($===null||$.getAttribute("data-type")!==H.NAV_LINK){var q=K.currentTarget;q.setAttribute(b.ATTR_SHOW,b.HIDDEN)}},navOnclick(K){var $=K.target;if($.getAttribute("data-type")===H.NAV_LINK){var q=$.getAttribute(b.ATTR_LINK_TYPE),F=K.currentTarget,Q=F.previousElementSibling;Q.replaceChildren(),Q.insertAdjacentText("beforeend",$.textContent),F.setAttribute(b.ATTR_SHOW,b.HIDDEN),F.setAttribute(b.ATTR_SELECTED,q),K.preventDefault()}}},A={select(K){return K[G(K.length)]},selectHero(K){if(K){if(!K.results||K.results.length===0)throw Error("trending.results does not have data");return A.select(K.results)}},async getHeroLogo(K){if(K===void 0)return;var{id:$,media_type:q}=K,F=await Y.getImages($,q);if(F.logos.length>0)return F.logos[0].file_path;else return},initDOMImgLogo(K,$){var q=$.lastElementChild.firstElementChild;if(K!==void 0)q.firstElementChild.setAttribute("data-opacity","0"),q.lastElementChild.setAttribute("data-display","1"),q.lastElementChild.setAttribute("src",`https://image.tmdb.org/t/p/w300${K}`)},initDOM(K,$){var q=$.firstElementChild.firstElementChild,F=$.lastElementChild,Q=F.firstElementChild.firstElementChild,_=F.lastElementChild;if(q.setAttribute("data-display","1"),q.setAttribute("src",`https://image.tmdb.org/t/p/w1280${K.backdrop_path}`),K.media_type==="tv")Q.insertAdjacentText("beforeend",K.name);else Q.insertAdjacentText("beforeend",K.title);F.setAttribute("data-media",K.media_type),F.setAttribute("data-id",K.id),_.insertAdjacentText("beforeend",K.overview)}},f={TYPE_SBUTTON:"data-sbuttont",topScroll:0,DOMCollButtonOnclick(K){var $=K.parentElement.lastElementChild;const q=K.parentElement.children[1],F=K.parentElement.children[2];var Q=K.getAttribute(f.TYPE_SBUTTON),_=$.clientWidth-$.clientWidth*6/100;if($.scrollLeft-_<=0)q.setAttribute("data-display","0");else q.setAttribute("data-display","1");if(Q==="0"){if($.scrollBy(-_,0),$.scrollLeft-_<=0)q.setAttribute("data-display","0");F.setAttribute("data-display","1")}else{if($.scrollBy(_,0),$.scrollLeft+_>=$.scrollWidth-$.clientWidth)F.setAttribute("data-display","0");q.setAttribute("data-display","1")}},async setItemImage(K,$,q){var F=await K,Q=$.firstElementChild;if(F===void 0||F.backdrops===void 0||F.backdrops.length===0){if(q!==null&&q.length>0)Q.setAttribute("src",`https://image.tmdb.org/t/p/w400${q}`),Q.setAttribute("data-display","1"),$.lastElementChild?.setAttribute("data-opacity","0")}else{var _=F.backdrops[0];Q.setAttribute("src",`https://image.tmdb.org/t/p/w400${_.file_path}`),Q.setAttribute("data-display","1"),$.lastElementChild?.setAttribute("data-opacity","0")}},createDOMCollection(K,$,q,F,Q){var _=F.content.cloneNode(!0),x=_.firstElementChild,z=x.children[0];z.insertAdjacentText("beforeend",K);for(var J of $){const X=Q.content.cloneNode(!0).firstElementChild;X.setAttribute("data-id",J.id);let Z,E;if(q!==void 0)E=q;else E=J.media_type;if(E==="movie")Z=J.title;else Z=J.name;X.setAttribute("title",Z),X.setAttribute("data-media",E),X.lastElementChild.insertAdjacentText("beforeend",Z),X.firstElementChild.setAttribute("alt",Z),f.setItemImage(Y.getImages(J.id,E),X,J.backdrop_path),x.lastElementChild.appendChild(X)}return x}},S={async open(K,$,q){var F=await Y.get($,q),Q;if($==="tv"){Q=K.children[0];var _=Q.children[1].firstElementChild.firstElementChild,x=Q.children[2].children[1],z=Q.children[2].children[2];if(F?.backdrop_path!=null)_.setAttribute("src",`https://image.tmdb.org/t/p/w780${F.backdrop_path}`),_.setAttribute("alt",F.name),_.setAttribute("data-display","1");x.textContent=F.name,z.textContent=F?.overview}else{Q=K.children[1];var _=Q.children[1].firstElementChild.firstElementChild,x=Q.children[2].children[1],z=Q.children[2].children[2];if(F?.backdrop_path!=null)_.setAttribute("src",`https://image.tmdb.org/t/p/w780${F.backdrop_path}`),_.setAttribute("alt",F.title),_.setAttribute("data-display","1");x.textContent=F.title,z.textContent=F?.overview}console.info(F)}};window.addEventListener("DOMContentLoaded",function(){var K={templateCollection:document.getElementById("template_collection"),templateCollSkeleton:document.getElementById("template_collection-skeleton"),templateCollItem:document.getElementById("template_collection-item"),templateIcons:document.getElementById("template_icons"),headerButtonNav:document.getElementById("header_button-nav"),headerNav:document.getElementById("header_nav"),headerButtonSearch:document.getElementById("header_button-search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),hero:document.getElementById("hero"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(K.templateCollection===null)throw Error("DOM.templateCollection is null");if(K.templateCollSkeleton===null)throw Error("DOM.templateCollSkeleton is null");if(K.templateCollItem===null)throw Error("DOM.templateCollItem is null");if(K.templateIcons===null)throw Error("DOM.templateIcons is null");if(K.headerButtonNav===null)throw Error("DOM.headerButtonNav is null");if(K.headerNav===null)throw Error("DOM.headerNav is null");if(K.headerButtonSearch===null)throw Error("DOM.headerButtonSearch is null");if(K.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(K.main===null)throw Error("DOM.main is null");if(K.hero===null)throw Error("DOM.hero is null");if(K.view===null)throw Error("DOM.view is null");if(K.buttonMore===null)throw Error("DOM.buttonMore is null");if(K.modal===null)throw Error("DOM.modal is null");W.init(),K.headerButtonTheme.setAttribute("data-type",W.current),K.headerButtonTheme.addEventListener("click",W.onclick),K.headerButtonNav.addEventListener("click",b.buttonNavOnclick),K.headerNav.addEventListener("focusout",b.navOnfocusout),K.headerNav.addEventListener("click",b.navOnclick),K.view.addEventListener("click",function(_){var x=_.target,z=x.getAttribute("data-type");if(z===H.COLL_BUTTON)f.DOMCollButtonOnclick(x);else if(z===H.COLL_ITEM){var J=x?.getAttribute("data-media"),X=x?.getAttribute("data-id");f.topScroll=document.firstElementChild.scrollTop,document.firstElementChild.scrollTop=0,K.modal.setAttribute("data-display","1"),K.modal.setAttribute("data-select",J),K.main.style.setProperty("transform",`translateY(-${f.topScroll}px)`),K.main.style.setProperty("position","fixed"),S.open(K.modal,J,X)}}),K.hero.lastElementChild.addEventListener("click",function(_){var x=_.target,z=x?.getAttribute("data-id");if(z!==void 0){var J=x?.getAttribute("data-media");f.topScroll=document.firstElementChild.scrollTop,document.firstElementChild.scrollTop=0,K.modal.setAttribute("data-display","1"),K.modal.setAttribute("data-select",J),K.main.style.setProperty("transform",`translateY(-${f.topScroll}px)`),K.main.style.setProperty("position","fixed"),S.open(K.modal,J,z)}}),K.modal.addEventListener("click",function(_){var x=_.target,z=x.getAttribute("data-type");if(z===H.MODAL||z===H.MODAL_CLOSE){K.modal.setAttribute("data-display","0");var z=K.modal.getAttribute("data-select"),J;if(z==="tv")J=K.modal.children[0];else J=K.modal.children[1];var X=J.children[1].firstElementChild?.firstElementChild,Z=J.children[2].children[1],E=J.children[2].children[2];X.setAttribute("data-display","0"),Z.textContent="",E.textContent="",K.main.style.removeProperty("transform"),K.main.style.setProperty("position","relative"),document.firstElementChild.scrollTop=f.topScroll}});var $=Y.getTrending("1");$.then(function(_){console.info("trending: ",_)});var q=$.then(A.selectHero);q.then(function(_){console.info("hero: ",_)}),q.then(A.getHeroLogo).then(function(_){A.initDOMImgLogo(_,K.hero)}),q.then(function(_){if(_!==void 0)A.initDOM(_,K.hero)}),$.then(function(_){if(_?.results===void 0||_.results.length===0)throw Error("API.getTrending does not have data");var x=f.createDOMCollection("Week Trendings",_.results,void 0,K.templateCollection,K.templateCollItem,K.templateIcons),z=K.view.children[0];z.insertAdjacentElement("beforebegin",x),z.remove()}),Y.getPopular("movie","1").then(function(_){if(console.info("getPopular movie",_),_?.results===void 0||_.results.length===0)throw Error("API.getDiscover does not have data");var x=f.createDOMCollection("Popular Movies",_.results,"movie",K.templateCollection,K.templateCollItem,K.templateIcons),z=K.view.children[1];z.insertAdjacentElement("beforebegin",x),z.remove()}),Y.getPopular("tv","1").then(function(_){if(console.info("getPopular tv",_),_?.results===void 0||_.results.length===0)throw Error("API.getDiscover does not have data");var x=f.createDOMCollection("Popular Tv series",_.results,"tv",K.templateCollection,K.templateCollItem,K.templateIcons),z=K.view.children[2];z.insertAdjacentElement("beforebegin",x),z.remove()}),Y.getTopRated("movie","1").then(function(_){if(console.info("getTopRate movie",_),_?.results===void 0||_.results.length===0)throw Error("API.getTopRated does not have data");var x=f.createDOMCollection("Top rated movie",_.results,"movie",K.templateCollection,K.templateCollItem,K.templateIcons),z=K.view.children[3];z.insertAdjacentElement("beforebegin",x),z.remove()}),Y.getTopRated("tv","1").then(function(_){if(console.info("getTopRate tv",_),_?.results===void 0||_.results.length===0)throw Error("API.getTopRated does not have data");var x=f.createDOMCollection("Top rated tv serie",_.results,"tv",K.templateCollection,K.templateCollItem,K.templateIcons),z=K.view.children[4];z.insertAdjacentElement("beforebegin",x),z.remove()});var F=Y.getGenres("movie"),Q=Y.getGenres("tv");Promise.all([F,Q]).then(function(_){if(console.info("movie genres",_[0]),console.info("tv genres",_[1]),_[0]===void 0||_[0].genres===void 0||_[0].genres.length===0)throw Error("API.getGenre does not have data");if(_[1]===void 0||_[1].genres===void 0||_[1].genres.length===0)throw Error("API.getGenre does not have data");var x=_[0].genres,z=_[1].genres;if(U.tvGenres=z,U.movieGenres=x,x.length+z.length<U.MAX)U.len=x.length+z.length;else U.len=U.MAX;if(console.info(U),K.buttonMore?.setAttribute("data-display","1"),x.length>1)B(x);if(z.length>1)B(z);var J,X,Z,E,j=0,k=0;for(let R=0;R<2;R+=1){if(Math.random()<0.5)X=x[j].id,Z=x[j].name,J="movie",E=`${Z} Movies`,j+=1,U.imov+=1;else X=z[k].id,Z=z[k].name,J="tv",E=`${Z} Tv series`,k+=1,U.itv+=1;C(Y.getDiscover(J,X,"1"),E,J,R,5,K)}}),K.buttonMore.addEventListener("click",function(_){var x,z,J,X,Z=U.movieGenres,E=U.tvGenres,j=U.itv,k=U.imov,R=0;K.buttonMore?.setAttribute("data-display","0");var w=0,V=!1;if(U.count+U.STEPS<U.len)w=U.count+U.STEPS;else w=U.len,V=!0;for(var L=U.count;L<w;L+=1){var N=K.templateCollSkeleton.content.cloneNode(!0);K.view?.appendChild(N)}for(var L=U.count;L<w;L+=1){if(j<E.length&&k<Z.length){if(Math.random()<0.5)R=1}else if(tv<E.length)R=1;if(R===0)z=Z[k].id,J=Z[k].name,x="movie",X=`${J} Movies`,k+=1,U.imov+=1;else z=E[j].id,J=E[j].name,x="tv",X=`${J} Tv series`,j+=1,U.itv+=1;U.count+=1,C(Y.getDiscover(x,z,"1"),X,x,L,K.view.children.length-w,K)}if(!V)K.buttonMore?.setAttribute("data-display","1")})});
