import I from"./general.js";import E from"./collection.js";var Q=function(f){var k,q,z,B,u=b.movieGenres,h=b.tvGenres,w=b.itv,X=b.imov,x=0;f.buttonMore?.setAttribute("data-display","0");var H=0,A=!1;if(b.count+b.STEPS<b.len)H=b.count+b.STEPS;else H=b.len,A=!0;for(var R=b.count;R<H;R+=1){var J=f.templateCollection.content.children[0].cloneNode(!0);f.view?.appendChild(J)}for(var R=b.count;R<H;R+=1){if(w<h.length&&X<u.length){if(Math.random()<0.5)x=1}else if(tv<h.length)x=1;if(x===0)q=u[X].id,z=u[X].name,k="movie",B=`${z} Movies`,X+=1,b.imov+=1;else q=h[w].id,z=h[w].name,k="tv",B=`${z} Tv Series`,w+=1,b.itv+=1;b.count+=1,E.View.discover(I.API.getDiscover(k,"1",q,void 0,void 0,void 0),B,k,q,R,f.view.children.length-H,f)}if(!A)f.buttonMore?.setAttribute("data-display","1")},b={MAX:15,STEPS:5,len:0,count:7,itv:0,tvGenres:null,imov:0,movieGenres:null};window.addEventListener("DOMContentLoaded",function(){var f={templateCollection:document.getElementById("template_collection"),templateModal:document.getElementById("template_modal"),headerPNav:document.getElementById("header_p_nav"),headerButtonSearch:document.getElementById("header_button-search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),hero:document.getElementById("hero"),heroTitle:document.getElementById("hero-title"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(f.templateCollection===null)throw Error("DOM.templateCollection is null");if(f.templateModal===null)throw Error("DOM.templateModal is null");if(f.headerPNav===null)throw Error("DOM.headerPNav is null");if(f.headerButtonSearch===null)throw Error("DOM.headerButtonSearch is null");if(f.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(f.main===null)throw Error("DOM.main is null");if(f.hero===null)throw Error("DOM.hero is null");if(f.heroTitle===null)throw Error("DOM.heroTitle is null");if(f.view===null)throw Error("DOM.view is null");if(f.buttonMore===null)throw Error("DOM.buttonMore is null");if(f.modal===null)throw Error("DOM.modal is null");I.Theme.init(),I.Route.init(f),window.addEventListener("popstate",function(){I.Route.onpopstate(f)}),f.headerButtonTheme.setAttribute("data-type",I.Theme.current),f.headerButtonTheme.addEventListener("click",I.Theme.onclick),f.headerPNav.firstElementChild.addEventListener("click",I.Nav.buttonNavOnclick),f.headerPNav.lastElementChild.addEventListener("focusout",I.Nav.navOnfocusout),f.view.addEventListener("click",function(u){E.View.onclick(u.target,f,u)}),f.heroTitle.addEventListener("click",function(u){I.Hero.DOMTitleOnclick(u.target,f,u)}),f.modal.addEventListener("click",function(u){I.Modal.onclick(u.target,f)}),f.modal.addEventListener("change",function(u){I.Modal.onchange(u.target,f)}),f.buttonMore.addEventListener("click",function(u){Q(f)});var k=I.API.getTrending("all","1");k.then(function(u){console.info("trending: ",u)});var q=k.then(I.Hero.selectHero);q.then(function(u){console.info("hero: ",u)}),q.then(I.Hero.getHeroLogo).then(function(u){I.Hero.initDOMImgLogo(u,f.hero)}),q.then(function(u){if(u!==void 0)I.Hero.initDOM(u,f.hero)}),k.then(function(u){if(u?.results===void 0||u.results.length===0)throw Error("API.getTrending does not have data");var h=E.Collection.createDOMCollection("Week Trendings",u.results,"all",E.Collection.TRENDING,void 0,f.templateCollection.content),w=f.view.children[0];w.insertAdjacentElement("beforebegin",h),w.remove()}),I.API.getPopular("movie","1").then(function(u){if(console.info("getPopular movie",u),u?.results===void 0||u.results.length===0)throw Error("API.getDiscover does not have data");var h=E.Collection.createDOMCollection("Popular Movies",u.results,"movie",E.Collection.POPULAR,void 0,f.templateCollection.content),w=f.view.children[1];w.insertAdjacentElement("beforebegin",h),w.remove()}),I.API.getPopular("tv","1").then(function(u){if(console.info("getPopular tv",u),u?.results===void 0||u.results.length===0)throw Error("API.getDiscover does not have data");var h=E.Collection.createDOMCollection("Popular Tv Series",u.results,"tv",E.Collection.POPULAR,void 0,f.templateCollection.content),w=f.view.children[2];w.insertAdjacentElement("beforebegin",h),w.remove()}),I.API.getTopRated("movie","1").then(function(u){if(console.info("getTopRate movie",u),u?.results===void 0||u.results.length===0)throw Error("API.getTopRated does not have data");var h=E.Collection.createDOMCollection("Top Rated Movie",u.results,"movie",E.Collection.TOP_RATED,void 0,f.templateCollection.content),w=f.view.children[3];w.insertAdjacentElement("beforebegin",h),w.remove()}),I.API.getTopRated("tv","1").then(function(u){if(console.info("getTopRate tv",u),u?.results===void 0||u.results.length===0)throw Error("API.getTopRated does not have data");var h=E.Collection.createDOMCollection("Top Rated Tv Serie",u.results,"tv",E.Collection.TOP_RATED,void 0,f.templateCollection.content),w=f.view.children[4];w.insertAdjacentElement("beforebegin",h),w.remove()});var z=I.API.getGenres("movie"),B=I.API.getGenres("tv");Promise.all([z,B]).then(function(u){if(console.info("movie genres",u[0]),console.info("tv genres",u[1]),u[0]===void 0||u[0].genres===void 0||u[0].genres.length===0)throw Error("API.getGenre does not have data");if(u[1]===void 0||u[1].genres===void 0||u[1].genres.length===0)throw Error("API.getGenre does not have data");var h=u[0].genres,w=u[1].genres;if(b.tvGenres=w,b.movieGenres=h,h.length+w.length<b.MAX)b.len=h.length+w.length;else b.len=b.MAX;if(console.info("Collection:",b),f.buttonMore?.setAttribute("data-display","1"),h.length>1)I.Utils.randomPermutation(h);if(w.length>1)I.Utils.randomPermutation(w);var X,x,H,A,R=0,J=0;for(let K=0;K<2;K+=1){if(Math.random()<0.5)x=h[R].id,H=h[R].name,X="movie",A=`${H} Movies`,R+=1,b.imov+=1;else x=w[J].id,H=w[J].name,X="tv",A=`${H} Tv Series`,J+=1,b.itv+=1;E.View.discover(I.API.getDiscover(X,"1",x,void 0,void 0,void 0),A,X,x,K,5,f)}})});
