import o from"./general.js";import l from"./collection.js";function M(e){var s,u,h,f,t=r.movieGenres,i=r.tvGenres,n=r.itv,v=r.imov,c=0;e.buttonMore?.setAttribute("data-display","0");var d=0,m=!1;if(r.count+r.STEPS<r.len)d=r.count+r.STEPS;else d=r.len,m=!0;for(var a=r.count;a<d;a+=1){var g=e.templateCollection.content.children[0].cloneNode(!0);e.view?.appendChild(g)}for(var a=r.count;a<d;a+=1){if(n<i.length&&v<t.length){if(Math.random()<0.5)c=1}else if(tv<i.length)c=1;if(c===0)u=t[v].id,h=t[v].name,s="movie",f=`${h} Movies`,v+=1,r.imov+=1;else u=i[n].id,h=i[n].name,s="tv",f=`${h} Tv Series`,n+=1,r.itv+=1;r.count+=1,l.View.discover(o.API.getDiscover(s,"1",u,void 0,void 0,void 0),f,s,u,a,e.view.children.length-d,e)}if(!m)e.buttonMore?.setAttribute("data-display","1")}var r={MAX:15,STEPS:5,len:0,count:7,itv:0,tvGenres:null,imov:0,movieGenres:null};window.addEventListener("DOMContentLoaded",function(){var e={templateCollection:document.getElementById("template_collection"),templateModal:document.getElementById("template_modal"),headerPNav:document.getElementById("header_p_nav"),headerSearch:document.getElementById("header_search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),hero:document.getElementById("hero"),heroTitle:document.getElementById("hero-title"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(e.templateCollection===null)throw Error("DOM.templateCollection is null");if(e.templateModal===null)throw Error("DOM.templateModal is null");if(e.headerPNav===null)throw Error("DOM.headerPNav is null");if(e.headerSearch===null)throw Error("DOM.headerSearch is null");if(e.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(e.main===null)throw Error("DOM.main is null");if(e.hero===null)throw Error("DOM.hero is null");if(e.heroTitle===null)throw Error("DOM.heroTitle is null");if(e.view===null)throw Error("DOM.view is null");if(e.buttonMore===null)throw Error("DOM.buttonMore is null");if(e.modal===null)throw Error("DOM.modal is null");o.Theme.init(),o.Route.init(e),window.addEventListener("popstate",function(){o.Route.onpopstate(e)}),e.headerButtonTheme.setAttribute("data-type",o.Theme.current),e.headerButtonTheme.addEventListener("click",o.Theme.onclick),e.headerPNav.firstElementChild.addEventListener("click",o.Nav.buttonNavOnclick),e.headerPNav.lastElementChild.addEventListener("focusout",o.Nav.navOnfocusout),e.headerSearch.children[1].addEventListener("click",function(t){e.headerSearch.reset()}),e.view.addEventListener("click",function(t){l.View.onclick(t.target,e,t)}),e.heroTitle.addEventListener("click",function(t){o.Hero.DOMTitleOnclick(t.target,e,t)}),e.modal.addEventListener("click",function(t){o.Modal.onclick(t.target,e)}),e.modal.addEventListener("change",function(t){o.Modal.onchange(t.target,e)}),e.buttonMore.addEventListener("click",function(t){M(e)});var s=o.API.getTrending("all","1"),u=s.then(o.Hero.selectHero);u.then(o.Hero.getHeroLogo).then(function(t){o.Hero.initDOMImgLogo(t,e.hero)}),u.then(function(t){if(t!==void 0)o.Hero.initDOM(t,e.hero)}),s.then(function(t){if(t?.results===void 0||t.results.length===0)throw Error("API.getTrending does not have data");var i=l.Collection.createDOMCollection("Week Trendings",t.results,"all",l.Collection.TRENDING,void 0,e.templateCollection.content),n=e.view.children[0];n.insertAdjacentElement("beforebegin",i),n.remove()}),o.API.getPopular("movie","1").then(function(t){if(t?.results===void 0||t.results.length===0)throw Error("API.getDiscover does not have data");var i=l.Collection.createDOMCollection("Popular Movies",t.results,"movie",l.Collection.POPULAR,void 0,e.templateCollection.content),n=e.view.children[1];n.insertAdjacentElement("beforebegin",i),n.remove()}),o.API.getPopular("tv","1").then(function(t){if(t?.results===void 0||t.results.length===0)throw Error("API.getDiscover does not have data");var i=l.Collection.createDOMCollection("Popular Tv Series",t.results,"tv",l.Collection.POPULAR,void 0,e.templateCollection.content),n=e.view.children[2];n.insertAdjacentElement("beforebegin",i),n.remove()}),o.API.getTopRated("movie","1").then(function(t){if(t?.results===void 0||t.results.length===0)throw Error("API.getTopRated does not have data");var i=l.Collection.createDOMCollection("Top Rated Movie",t.results,"movie",l.Collection.TOP_RATED,void 0,e.templateCollection.content),n=e.view.children[3];n.insertAdjacentElement("beforebegin",i),n.remove()}),o.API.getTopRated("tv","1").then(function(t){if(t?.results===void 0||t.results.length===0)throw Error("API.getTopRated does not have data");var i=l.Collection.createDOMCollection("Top Rated Tv Serie",t.results,"tv",l.Collection.TOP_RATED,void 0,e.templateCollection.content),n=e.view.children[4];n.insertAdjacentElement("beforebegin",i),n.remove()});var h=o.API.getGenres("movie"),f=o.API.getGenres("tv");Promise.all([h,f]).then(function(t){if(t[0]===void 0||t[0].genres===void 0||t[0].genres.length===0)throw Error("API.getGenre does not have data");if(t[1]===void 0||t[1].genres===void 0||t[1].genres.length===0)throw Error("API.getGenre does not have data");var i=t[0].genres,n=t[1].genres;if(r.tvGenres=n,r.movieGenres=i,i.length+n.length<r.MAX)r.len=i.length+n.length;else r.len=r.MAX;if(e.buttonMore?.setAttribute("data-display","1"),i.length>1)o.Utils.randomPermutation(i);if(n.length>1)o.Utils.randomPermutation(n);var v,c,d,m,a=0,g=0;for(let E=0;E<2;E+=1){if(Math.random()<0.5)c=i[a].id,d=i[a].name,v="movie",m=`${d} Movies`,a+=1,r.imov+=1;else c=n[g].id,d=n[g].name,v="tv",m=`${d} Tv Series`,g+=1,r.itv+=1;l.View.discover(o.API.getDiscover(v,"1",c,void 0,void 0,void 0),m,v,c,E,5,e)}})});
