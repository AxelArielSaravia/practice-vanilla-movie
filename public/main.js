import E from"./general.js";var U=function(B){var x,z,I,K,u=w.movieGenres,A=w.tvGenres,b=w.itv,q=w.imov,H=0;B.buttonMore?.setAttribute("data-display","0");var V=0,J=!1;if(w.count+w.STEPS<w.len)V=w.count+w.STEPS;else V=w.len,J=!0;for(var h=w.count;h<V;h+=1){var Q=B.templateCollection.content.children[0].cloneNode(!0);B.view?.appendChild(Q)}for(var h=w.count;h<V;h+=1){if(b<A.length&&q<u.length){if(Math.random()<0.5)H=1}else if(tv<A.length)H=1;if(H===0)z=u[q].id,I=u[q].name,x="movie",K=`${I} Movies`,q+=1,w.imov+=1;else z=A[b].id,I=A[b].name,x="tv",K=`${I} Tv series`,b+=1,w.itv+=1;w.count+=1,E.View.discover(E.API.getDiscover(x,z,"1"),K,x,h,B.view.children.length-V,B)}if(!J)B.buttonMore?.setAttribute("data-display","1")},w={MAX:15,STEPS:5,len:0,count:7,itv:0,tvGenres:null,imov:0,movieGenres:null};window.addEventListener("DOMContentLoaded",function(){var B={templateCollection:document.getElementById("template_collection"),templateModal:document.getElementById("template_modal"),headerButtonNav:document.getElementById("header_button-nav"),headerNav:document.getElementById("header_nav"),headerButtonSearch:document.getElementById("header_button-search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),hero:document.getElementById("hero"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(B.templateCollection===null)throw Error("DOM.templateCollection is null");if(B.templateModal===null)throw Error("DOM.templateModal is null");if(B.headerButtonNav===null)throw Error("DOM.headerButtonNav is null");if(B.headerNav===null)throw Error("DOM.headerNav is null");if(B.headerButtonSearch===null)throw Error("DOM.headerButtonSearch is null");if(B.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(B.main===null)throw Error("DOM.main is null");if(B.hero===null)throw Error("DOM.hero is null");if(B.view===null)throw Error("DOM.view is null");if(B.buttonMore===null)throw Error("DOM.buttonMore is null");if(B.modal===null)throw Error("DOM.modal is null");E.Theme.init(),E.Route.init(B),window.addEventListener("popstate",function(){E.Route.onpopstate(B)}),B.headerButtonTheme.setAttribute("data-type",E.Theme.current),B.headerButtonTheme.addEventListener("click",E.Theme.onclick),B.headerButtonNav.addEventListener("click",E.Nav.buttonNavOnclick),B.headerNav.addEventListener("focusout",E.Nav.navOnfocusout),B.view.addEventListener("click",function(u){E.View.onclick(u.target,B,u)}),B.hero.lastElementChild.addEventListener("click",function(u){E.Hero.DOMTitleOnclick(u.target,B,u)}),B.modal.addEventListener("click",function(u){E.Modal.onclick(u.target,B)}),B.modal.addEventListener("change",function(u){E.Modal.onchange(u.target,B)}),B.buttonMore.addEventListener("click",function(u){U(B)});var x=E.API.getTrending("all","1");x.then(function(u){console.info("trending: ",u)});var z=x.then(E.Hero.selectHero);z.then(function(u){console.info("hero: ",u)}),z.then(E.Hero.getHeroLogo).then(function(u){E.Hero.initDOMImgLogo(u,B.hero)}),z.then(function(u){if(u!==void 0)E.Hero.initDOM(u,B.hero)}),x.then(function(u){if(u?.results===void 0||u.results.length===0)throw Error("API.getTrending does not have data");var A=E.Collection.createDOMCollection("Week Trendings",u.results,"all",E.Collection.TRENDING,B.templateCollection.content),b=B.view.children[0];b.insertAdjacentElement("beforebegin",A),b.remove()}),E.API.getPopular("movie","1").then(function(u){if(console.info("getPopular movie",u),u?.results===void 0||u.results.length===0)throw Error("API.getDiscover does not have data");var A=E.Collection.createDOMCollection("Popular Movies",u.results,"movie",E.Collection.POPULAR,B.templateCollection.content),b=B.view.children[1];b.insertAdjacentElement("beforebegin",A),b.remove()}),E.API.getPopular("tv","1").then(function(u){if(console.info("getPopular tv",u),u?.results===void 0||u.results.length===0)throw Error("API.getDiscover does not have data");var A=E.Collection.createDOMCollection("Popular Tv series",u.results,"tv",E.Collection.POPULAR,B.templateCollection.content),b=B.view.children[2];b.insertAdjacentElement("beforebegin",A),b.remove()}),E.API.getTopRated("movie","1").then(function(u){if(console.info("getTopRate movie",u),u?.results===void 0||u.results.length===0)throw Error("API.getTopRated does not have data");var A=E.Collection.createDOMCollection("Top rated movie",u.results,"movie",E.Collection.TOP_RATED,B.templateCollection.content),b=B.view.children[3];b.insertAdjacentElement("beforebegin",A),b.remove()}),E.API.getTopRated("tv","1").then(function(u){if(console.info("getTopRate tv",u),u?.results===void 0||u.results.length===0)throw Error("API.getTopRated does not have data");var A=E.Collection.createDOMCollection("Top rated tv serie",u.results,"tv",E.Collection.TOP_RATED,B.templateCollection.content),b=B.view.children[4];b.insertAdjacentElement("beforebegin",A),b.remove()});var I=E.API.getGenres("movie"),K=E.API.getGenres("tv");Promise.all([I,K]).then(function(u){if(console.info("movie genres",u[0]),console.info("tv genres",u[1]),u[0]===void 0||u[0].genres===void 0||u[0].genres.length===0)throw Error("API.getGenre does not have data");if(u[1]===void 0||u[1].genres===void 0||u[1].genres.length===0)throw Error("API.getGenre does not have data");var A=u[0].genres,b=u[1].genres;if(w.tvGenres=b,w.movieGenres=A,A.length+b.length<w.MAX)w.len=A.length+b.length;else w.len=w.MAX;if(console.info("Collection:",w),B.buttonMore?.setAttribute("data-display","1"),A.length>1)E.Utils.randomPermutation(A);if(b.length>1)E.Utils.randomPermutation(b);var q,H,V,J,h=0,Q=0;for(let R=0;R<2;R+=1){if(Math.random()<0.5)H=A[h].id,V=A[h].name,q="movie",J=`${V} Movies`,h+=1,w.imov+=1;else H=b[Q].id,V=b[Q].name,q="tv",J=`${V} Tv series`,Q+=1,w.itv+=1;E.View.discover(E.API.getDiscover(q,H,"1"),J,q,R,5,B)}})});
