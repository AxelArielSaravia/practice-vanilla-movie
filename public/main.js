var k=function(_){if(_.ok)return _.json()};var C={getTrending(_="1"){return fetch(`${window.location.origin}/api/trending?page=${_}`).then(k)},getPopular(_,U="1"){return fetch(`${window.location.origin}/api/popular?type=${_}&page=${U}`).then(k)},getDiscover(_,U,$="1"){var z=`${window.location.origin}/api/discover?type=${_}&page=${$}`;if(U!==void 0)z=`${z}&genre=${U}`;return fetch(z).then(k)},getImages(_,U){return fetch(`${window.location.origin}/api/images?type=${U}&id=${_}`).then(k)},getGenres(_){return fetch(`${window.location.origin}/api/genres?type=${_}`).then(k)},getTopRated(_,U="1"){return fetch(`${window.location.origin}/api/toprated?type=${_}&page=${U}`).then(k)}},Y=C;var y=function(_){return Math.floor(Math.random()*_)},H=function(_){var U=_.length;for(var $=0;$<U-1;$+=1){var z=$+Math.floor(Math.random()*(U-$)),F=_[$];_[$]=_[z],_[z]=F}};async function T(_,U,$,z){var F=await _,K=U.firstElementChild;if(F===void 0||F.backdrops===void 0||F.backdrops.length===0){if(z!==null&&z.length>0)K.setAttribute("src",`https://image.tmdb.org/t/p/w400${z}`),K.setAttribute("data-display","1"),U.lastElementChild?.setAttribute("data-opacity","0")}else{var q=F.backdrops[0];K.setAttribute("src",`https://image.tmdb.org/t/p/w400${q.file_path}`),K.setAttribute("data-display","1"),U.lastElementChild?.setAttribute("data-opacity","0")}}var b=function(_,U,$,z,F,K){var q=z.content.cloneNode(!0),w=q.firstElementChild,Z=w.children[0];Z.insertAdjacentText("beforeend",_);for(var x of U){const W=F.content.cloneNode(!0).firstElementChild;W.setAttribute("data-id",x.id);let E,V;if($!==void 0)V=$;else V=x.media_type;if(V==="movie")E=x.title;else E=x.name;W.setAttribute("title",E),W.lastElementChild.insertAdjacentText("beforeend",E),W.firstElementChild.setAttribute("alt",E),T(Y.getImages(x.id,V),W,K,x.backdrop_path),w.lastElementChild.appendChild(W)}return w};async function N(_,U,$,z,F,K){var q=await _;if(console.info(U,q),q?.results===void 0||q.results.length===0)throw Error("API.getTopRated does not have data");var w=b(U,q.results,$,K.templateCollection,K.templateCollItem,K.templateIcons),Z=K.view.children[F+z];Z.insertAdjacentElement("beforebegin",w),Z.remove()}var B={NAV_LINK:"0",COLL_TITLE:"4",COLL_BUTTON:"5"},J={MAX:15,STEPS:5,len:0,count:7,itv:0,tvGenres:null,imov:0,movieGenres:null},P={pointerFine:window.matchMedia("(pointer: fine)")},Q={current:"dark",DARK:"dark",LIGHT:"light",init(){var _=localStorage.getItem("theme");if(_==="dark"||_==="light")Q.current=_;else{if(window.matchMedia!==void 0&&window.matchMedia("(prefers-color-scheme: dark)").matches)Q.current=Q.DARK;else Q.current=Q.LIGHT;localStorage.setItem("theme",Q.current)}document.firstElementChild?.setAttribute("class",Q.current)},change(_){localStorage.setItem("theme",_),document.firstElementChild?.setAttribute("class",Q.current)},onclick(_){var U=_.currentTarget;if(U===null)return;if(Q.current===Q.DARK)Q.current=Q.LIGHT;else Q.current=Q.DARK;U.setAttribute("data-type",Q.current),Q.change(Q.current)}},X={ATTR_SHOW:"data-mbshow",ATTR_SELECTED:"data-selected",ATTR_LINK_TYPE:"data-linkt",HIDDEN:"0",SHOW:"1",buttonNavOnclick(_){console.info(_);var U=_.currentTarget,$=U.nextElementSibling;if($.getAttribute(X.ATTR_SHOW)===X.HIDDEN)$.setAttribute(X.ATTR_SHOW,X.SHOW),$.firstElementChild.firstElementChild.focus();else $.setAttribute(X.ATTR_SHOW,X.HIDDEN)},navOnfocusout(_){var U=_.relatedTarget;if(U===null||U.getAttribute("data-type")!==B.NAV_LINK){var $=_.currentTarget;$.setAttribute(X.ATTR_SHOW,X.HIDDEN)}},navOnclick(_){var U=_.target;if(U.getAttribute("data-type")===B.NAV_LINK){var $=U.getAttribute(X.ATTR_LINK_TYPE),z=_.currentTarget,F=z.previousElementSibling;F.replaceChildren(),F.insertAdjacentText("beforeend",U.textContent),z.setAttribute(X.ATTR_SHOW,X.HIDDEN),z.setAttribute(X.ATTR_SELECTED,$),_.preventDefault()}}},L={select(_){return _[y(_.length)]},selectHero(_){if(_){if(!_.results||_.results.length===0)throw Error("trending.results does not have data");return L.select(_.results)}},async getHeroLogo(_){if(_===void 0)return;var{id:U,media_type:$}=_,z=await Y.getImages(U,$);if(z.logos.length>0)return z.logos[0].file_path;else return},initDOMImgLogo(_,U){var $=U.lastElementChild.firstElementChild;if(_!==void 0)$.firstElementChild.setAttribute("data-opacity","0"),$.lastElementChild.setAttribute("data-display","1"),$.lastElementChild.setAttribute("src",`https://image.tmdb.org/t/p/w300${_}`)},initDOM(_,U){var $=U.firstElementChild.firstElementChild,z=U.lastElementChild,F=z.firstElementChild.firstElementChild,K=z.children[2];if($.setAttribute("data-display","1"),$.setAttribute("src",`https://image.tmdb.org/t/p/w1280${_.backdrop_path}`),_.media_type==="tv")F.insertAdjacentText("beforeend",_.name);else F.insertAdjacentText("beforeend",_.title);K.insertAdjacentText("beforeend",_.overview)}},A={TYPE_SBUTTON:"data-sbuttont",onclick(_){var U=_.target;if(U?.getAttribute("data-type")===B.COLL_BUTTON){var $=U.parentElement.lastElementChild;const K=U.parentElement.children[1],q=U.parentElement.children[2];var z=U.getAttribute(A.TYPE_SBUTTON),F=$.clientWidth-$.clientWidth*6/100;if($.scrollLeft-F<=0)K.setAttribute("data-display","0");else K.setAttribute("data-display","1");if(z==="0"){if($.scrollBy(-F,0),$.scrollLeft-F<=0)K.setAttribute("data-display","0");q.setAttribute("data-display","1")}else{if($.scrollBy(F,0),$.scrollLeft+F>=$.scrollWidth-$.clientWidth)q.setAttribute("data-display","0");K.setAttribute("data-display","1")}}}};window.addEventListener("DOMContentLoaded",function(){var _={templateCollection:document.getElementById("template_collection"),templateCollSkeleton:document.getElementById("template_collection-skeleton"),templateCollItem:document.getElementById("template_collection-item"),templateIcons:document.getElementById("template_icons"),headerButtonNav:document.getElementById("header_button-nav"),headerNav:document.getElementById("header_nav"),headerButtonSearch:document.getElementById("header_button-search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),hero:document.getElementById("hero"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more")};if(_.templateCollection===null)throw Error("DOM.templateCollection is null");if(_.templateCollSkeleton===null)throw Error("DOM.templateCollSkeleton is null");if(_.templateCollItem===null)throw Error("DOM.templateCollItem is null");if(_.templateIcons===null)throw Error("DOM.templateIcons is null");if(_.headerButtonNav===null)throw Error("DOM.headerButtonNav is null");if(_.headerNav===null)throw Error("DOM.headerNav is null");if(_.headerButtonSearch===null)throw Error("DOM.headerButtonSearch is null");if(_.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(_.main===null)throw Error("DOM.main is null");if(_.hero===null)throw Error("DOM.hero is null");if(_.view===null)throw Error("DOM.view is null");if(_.buttonMore===null)throw Error("DOM.buttonMore is null");if(Q.init(),_.headerButtonTheme.setAttribute("data-type",Q.current),_.headerButtonTheme.addEventListener("click",Q.onclick),_.headerButtonNav.addEventListener("click",X.buttonNavOnclick),_.headerNav.addEventListener("focusout",X.navOnfocusout),_.headerNav.addEventListener("click",X.navOnclick),P.pointerFine.matches)_.view.onclick=A.onclick;P.pointerFine.onchange=function(K){if(K.matches)_.view.onclick=A.onclick;else _.view.onclick=null};var U=Y.getTrending("1");U.then(function(K){console.info("trending: ",K)});var $=U.then(L.selectHero);$.then(function(K){console.info("hero: ",K)}),$.then(L.getHeroLogo).then(function(K){L.initDOMImgLogo(K,_.hero)}),$.then(function(K){if(K!==void 0)L.initDOM(K,_.hero)}),U.then(function(K){if(K?.results===void 0||K.results.length===0)throw Error("API.getTrending does not have data");var q=b("Week Trendings",K.results,void 0,_.templateCollection,_.templateCollItem,_.templateIcons),w=_.view.children[0];w.insertAdjacentElement("beforebegin",q),w.remove()}),Y.getPopular("movie","1").then(function(K){if(console.info("getPopular movie",K),K?.results===void 0||K.results.length===0)throw Error("API.getDiscover does not have data");var q=b("Popular Movies",K.results,"movie",_.templateCollection,_.templateCollItem,_.templateIcons),w=_.view.children[1];w.insertAdjacentElement("beforebegin",q),w.remove()}),Y.getPopular("tv","1").then(function(K){if(console.info("getPopular tv",K),K?.results===void 0||K.results.length===0)throw Error("API.getDiscover does not have data");var q=b("Popular Tv series",K.results,"tv",_.templateCollection,_.templateCollItem,_.templateIcons),w=_.view.children[2];w.insertAdjacentElement("beforebegin",q),w.remove()}),Y.getTopRated("movie","1").then(function(K){if(console.info("getTopRate movie",K),K?.results===void 0||K.results.length===0)throw Error("API.getTopRated does not have data");var q=b("Top rated movie",K.results,"movie",_.templateCollection,_.templateCollItem,_.templateIcons),w=_.view.children[3];w.insertAdjacentElement("beforebegin",q),w.remove()}),Y.getTopRated("tv","1").then(function(K){if(console.info("getTopRate tv",K),K?.results===void 0||K.results.length===0)throw Error("API.getTopRated does not have data");var q=b("Top rated tv serie",K.results,"tv",_.templateCollection,_.templateCollItem,_.templateIcons),w=_.view.children[4];w.insertAdjacentElement("beforebegin",q),w.remove()});var z=Y.getGenres("movie"),F=Y.getGenres("tv");Promise.all([z,F]).then(function(K){if(console.info("movie genres",K[0]),console.info("tv genres",K[1]),K[0]===void 0||K[0].genres===void 0||K[0].genres.length===0)throw Error("API.getGenre does not have data");if(K[1]===void 0||K[1].genres===void 0||K[1].genres.length===0)throw Error("API.getGenre does not have data");var q=K[0].genres,w=K[1].genres;if(J.tvGenres=w,J.movieGenres=q,q.length+w.length<J.MAX)J.len=q.length+w.length;else J.len=J.MAX;if(console.info(J),_.buttonMore?.setAttribute("data-display","1"),q.length>1)H(q);if(w.length>1)H(w);var Z,x,W,E,V=0,u=0;for(let j=0;j<2;j+=1){if(Math.random()<0.5)x=q[V].id,W=q[V].name,Z="movie",E=`${W} Movies`,V+=1,J.imov+=1;else x=w[u].id,W=w[u].name,Z="tv",E=`${W} Tv series`,u+=1,J.itv+=1;N(Y.getDiscover(Z,x,"1"),E,Z,j,5,_)}}),_.buttonMore.addEventListener("click",function(K){var q,w,Z,x,W=J.movieGenres,E=J.tvGenres,V=J.itv,u=J.imov,j=0;_.buttonMore?.setAttribute("data-display","0");var f=0,G=!1;if(J.count+J.STEPS<J.len)f=J.count+J.STEPS;else f=J.len,G=!0;for(var R=J.count;R<f;R+=1){var S=_.templateCollSkeleton.content.cloneNode(!0);_.view?.appendChild(S)}for(var R=J.count;R<f;R+=1){if(V<E.length&&u<W.length){if(Math.random()<0.5)j=1}else if(tv<E.length)j=1;if(j===0)w=W[u].id,Z=W[u].name,q="movie",x=`${Z} Movies`,u+=1,J.imov+=1;else w=E[V].id,Z=E[V].name,q="tv",x=`${Z} Tv series`,V+=1,J.itv+=1;J.count+=1,N(Y.getDiscover(q,w,"1"),x,q,R,_.view.children.length-f,_)}if(!G)_.buttonMore?.setAttribute("data-display","1")})});
