import b from"./general.js";import B from"./collection.js";var U=function(f){var x,z,H,K,u=h.movieGenres,A=h.tvGenres,E=h.itv,q=h.imov,w=0;f.buttonMore?.setAttribute("data-display","0");var I=0,J=!1;if(h.count+h.STEPS<h.len)I=h.count+h.STEPS;else I=h.len,J=!0;for(var X=h.count;X<I;X+=1){var Q=f.templateCollection.content.children[0].cloneNode(!0);f.view?.appendChild(Q)}for(var X=h.count;X<I;X+=1){if(E<A.length&&q<u.length){if(Math.random()<0.5)w=1}else if(tv<A.length)w=1;if(w===0)z=u[q].id,H=u[q].name,x="movie",K=`${H} Movies`,q+=1,h.imov+=1;else z=A[E].id,H=A[E].name,x="tv",K=`${H} Tv Series`,E+=1,h.itv+=1;h.count+=1,B.View.discover(b.API.getDiscover(x,"1",z,void 0,void 0,void 0),K,x,z,X,f.view.children.length-I,f)}if(!J)f.buttonMore?.setAttribute("data-display","1")},h={MAX:15,STEPS:5,len:0,count:7,itv:0,tvGenres:null,imov:0,movieGenres:null};window.addEventListener("DOMContentLoaded",function(){var f={templateCollection:document.getElementById("template_collection"),templateModal:document.getElementById("template_modal"),headerPNav:document.getElementById("header_p_nav"),headerSearch:document.getElementById("header_search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),hero:document.getElementById("hero"),heroTitle:document.getElementById("hero-title"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(f.templateCollection===null)throw Error("DOM.templateCollection is null");if(f.templateModal===null)throw Error("DOM.templateModal is null");if(f.headerPNav===null)throw Error("DOM.headerPNav is null");if(f.headerSearch===null)throw Error("DOM.headerSearch is null");if(f.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(f.main===null)throw Error("DOM.main is null");if(f.hero===null)throw Error("DOM.hero is null");if(f.heroTitle===null)throw Error("DOM.heroTitle is null");if(f.view===null)throw Error("DOM.view is null");if(f.buttonMore===null)throw Error("DOM.buttonMore is null");if(f.modal===null)throw Error("DOM.modal is null");b.Theme.init(),b.Route.init(f),window.addEventListener("popstate",function(){b.Route.onpopstate(f)}),f.headerButtonTheme.setAttribute("data-type",b.Theme.current),f.headerButtonTheme.addEventListener("click",b.Theme.onclick),f.headerPNav.firstElementChild.addEventListener("click",b.Nav.buttonNavOnclick),f.headerPNav.lastElementChild.addEventListener("focusout",b.Nav.navOnfocusout),f.headerSearch.children[1].addEventListener("click",function(u){f.headerSearch.reset()}),f.view.addEventListener("click",function(u){B.View.onclick(u.target,f,u)}),f.heroTitle.addEventListener("click",function(u){b.Hero.DOMTitleOnclick(u.target,f,u)}),f.modal.addEventListener("click",function(u){b.Modal.onclick(u.target,f)}),f.modal.addEventListener("change",function(u){b.Modal.onchange(u.target,f)}),f.buttonMore.addEventListener("click",function(u){U(f)});var x=b.API.getTrending("all","1"),z=x.then(b.Hero.selectHero);z.then(b.Hero.getHeroLogo).then(function(u){b.Hero.initDOMImgLogo(u,f.hero)}),z.then(function(u){if(u!==void 0)b.Hero.initDOM(u,f.hero)}),x.then(function(u){if(u?.results===void 0||u.results.length===0)throw Error("API.getTrending does not have data");var A=B.Collection.createDOMCollection("Week Trendings",u.results,"all",B.Collection.TRENDING,void 0,f.templateCollection.content),E=f.view.children[0];E.insertAdjacentElement("beforebegin",A),E.remove()}),b.API.getPopular("movie","1").then(function(u){if(u?.results===void 0||u.results.length===0)throw Error("API.getDiscover does not have data");var A=B.Collection.createDOMCollection("Popular Movies",u.results,"movie",B.Collection.POPULAR,void 0,f.templateCollection.content),E=f.view.children[1];E.insertAdjacentElement("beforebegin",A),E.remove()}),b.API.getPopular("tv","1").then(function(u){if(u?.results===void 0||u.results.length===0)throw Error("API.getDiscover does not have data");var A=B.Collection.createDOMCollection("Popular Tv Series",u.results,"tv",B.Collection.POPULAR,void 0,f.templateCollection.content),E=f.view.children[2];E.insertAdjacentElement("beforebegin",A),E.remove()}),b.API.getTopRated("movie","1").then(function(u){if(u?.results===void 0||u.results.length===0)throw Error("API.getTopRated does not have data");var A=B.Collection.createDOMCollection("Top Rated Movie",u.results,"movie",B.Collection.TOP_RATED,void 0,f.templateCollection.content),E=f.view.children[3];E.insertAdjacentElement("beforebegin",A),E.remove()}),b.API.getTopRated("tv","1").then(function(u){if(u?.results===void 0||u.results.length===0)throw Error("API.getTopRated does not have data");var A=B.Collection.createDOMCollection("Top Rated Tv Serie",u.results,"tv",B.Collection.TOP_RATED,void 0,f.templateCollection.content),E=f.view.children[4];E.insertAdjacentElement("beforebegin",A),E.remove()});var H=b.API.getGenres("movie"),K=b.API.getGenres("tv");Promise.all([H,K]).then(function(u){if(u[0]===void 0||u[0].genres===void 0||u[0].genres.length===0)throw Error("API.getGenre does not have data");if(u[1]===void 0||u[1].genres===void 0||u[1].genres.length===0)throw Error("API.getGenre does not have data");var A=u[0].genres,E=u[1].genres;if(h.tvGenres=E,h.movieGenres=A,A.length+E.length<h.MAX)h.len=A.length+E.length;else h.len=h.MAX;if(f.buttonMore?.setAttribute("data-display","1"),A.length>1)b.Utils.randomPermutation(A);if(E.length>1)b.Utils.randomPermutation(E);var q,w,I,J,X=0,Q=0;for(let R=0;R<2;R+=1){if(Math.random()<0.5)w=A[X].id,I=A[X].name,q="movie",J=`${I} Movies`,X+=1,h.imov+=1;else w=E[Q].id,I=E[Q].name,q="tv",J=`${I} Tv Series`,Q+=1,h.itv+=1;B.View.discover(b.API.getDiscover(q,"1",w,void 0,void 0,void 0),J,q,w,R,5,f)}})});
