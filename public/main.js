var X=function(k){if(k.ok)return k.json()};var B={getTrending(k="1"){return fetch(`http://127.0.0.1:3333/api/trending?page=${k}`).then(X)},getPopular(k,u="1"){return fetch(`http://127.0.0.1:3333/api/popular?type=${k}&page=${u}`).then(X)},getDiscover(k,u,U="1"){var $=`http://127.0.0.1:3333/api/discover?type=${k}&page=${U}`;if(u!==void 0)$=`${$}&genre=${u}`;return fetch($).then(X)},getImages(k,u,U="1"){return fetch(`http://127.0.0.1:3333/api/images?type=${u}&id=${k}&page=${U}`).then(X)},getGenres(k){return fetch(`http://127.0.0.1:3333/api/genres?type=${k}`).then(X)},getTopRated(k,u="1"){return fetch(`http://127.0.0.1:3333/api/toprated?type=${k}&page=${u}`).then(X)}},K=B;var G=function(k){return Math.floor(Math.random()*k)};async function H(k,u,U){const $=await k;if($===void 0||$.backdrops===void 0||$.backdrops.length===0){u.firstElementChild.setAttribute("data-display","1");var E=U.content.firstElementChild?.cloneNode(!0);u.appendChild(E)}else{const _=$.backdrops[0],q=u.lastElementChild;q.setAttribute("src",`https://image.tmdb.org/t/p/w400${_.file_path}`),q.setAttribute("data-display","1")}}var Z=function(k,u,U,$,E,_){const b=$.content.cloneNode(!0).firstElementChild;b.children[0].insertAdjacentText("beforeend",k);for(let Q of u){const W=E.content.cloneNode(!0).firstElementChild;W.setAttribute("data-id",Q.id);let z,J;if(U!==void 0)J=U;else J=Q.media_type;if(J==="movie")z=Q.title;else z=Q.name;W.setAttribute("title",z),W.firstElementChild.insertAdjacentText("beforeend",z),W.lastElementChild.setAttribute("alt",z),H(K.getImages(Q.id,J),W,_),b.lastElementChild.appendChild(W)}return b},Y={NAV_LINK:"0",COLL_TITLE:"4",COLL_BUTTON:"5"},L={MAX:20,genresMax:0,count:7},w={current:"dark",DARK:"dark",LIGHT:"light",init(){const k=localStorage.getItem("theme");if(k==="dark"||k==="light")w.current=k;else{if(window.matchMedia!==void 0&&window.matchMedia("(prefers-color-scheme: dark)").matches)w.current=w.DARK;else w.current=w.LIGHT;localStorage.setItem("theme",w.current)}document.firstElementChild?.setAttribute("class",w.current)},change(k){localStorage.setItem("theme",k),document.firstElementChild?.setAttribute("class",w.current)},onclick(k){const u=k.currentTarget;if(u===null)return;if(w.current===w.DARK)w.current=w.LIGHT;else w.current=w.DARK;u.setAttribute("data-type",w.current),w.change(w.current)}},F={ATTR_SHOW:"data-mbshow",ATTR_SELECTED:"data-selected",ATTR_LINK_TYPE:"data-linkt",HIDDEN:"0",SHOW:"1",buttonNavOnclick(k){console.info(k);const U=k.currentTarget.nextElementSibling;if(U.getAttribute(F.ATTR_SHOW)===F.HIDDEN)U.setAttribute(F.ATTR_SHOW,F.SHOW),U.firstElementChild.firstElementChild.focus();else U.setAttribute(F.ATTR_SHOW,F.HIDDEN)},navOnfocusout(k){const u=k.relatedTarget;if(u===null||u.getAttribute("data-type")!==Y.NAV_LINK)k.currentTarget.setAttribute(F.ATTR_SHOW,F.HIDDEN)},navOnclick(k){const u=k.target;if(u.getAttribute("data-type")===Y.NAV_LINK){const U=u.getAttribute(F.ATTR_LINK_TYPE),$=k.currentTarget,E=$.previousElementSibling;E.replaceChildren(),E.insertAdjacentText("beforeend",u.textContent),$.setAttribute(F.ATTR_SHOW,F.HIDDEN),$.setAttribute(F.ATTR_SELECTED,U),k.preventDefault()}}},x={select(k){const u=G(k.length);return k[u]},selectHero(k){if(k){if(!k.results||k.results.length===0)throw Error("trending.results does not have data");return x.select(k.results)}},async getHeroLogo(k){if(k===void 0)return;const{id:u,media_type:U}=k;let $=await K.getImages(u,U);if($.logos.length>0)return $.logos[0].file_path;else return},initDOMImgLogo(k,u){const U=u.lastElementChild.firstElementChild;if(k)U.lastElementChild.setAttribute("data-display","1"),U.lastElementChild.setAttribute("src",`https://image.tmdb.org/t/p/w300${k}`);else U.firstElementChild.setAttribute("data-display","1")},initDOM(k,u){const U=u.firstElementChild.firstElementChild,$=u.lastElementChild,E=$.firstElementChild.firstElementChild,_=$.children[2];U.setAttribute("data-display","1"),U.setAttribute("src",`https://image.tmdb.org/t/p/w1280${k.backdrop_path}`),E.textContent=k.title,_.textContent=k.overview}},f={TYPE_SBUTTON:"data-sbuttont",onclick(k){var u=k.target;if(u?.getAttribute("data-type")===Y.COLL_BUTTON){var U=u.parentElement.lastElementChild;const _=u.parentElement.children[1],q=u.parentElement.children[2];var $=u.getAttribute(f.TYPE_SBUTTON),E=U.clientWidth-U.clientWidth*6/100;if(U.scrollLeft-E<=0)_.setAttribute("data-display","0");else _.setAttribute("data-display","1");if($==="0"){if(U.scrollBy(-E,0),U.scrollLeft-E<=0)_.setAttribute("data-display","0");q.setAttribute("data-display","1")}else{if(U.scrollBy(E,0),U.scrollLeft+E>=U.scrollWidth-U.clientWidth)q.setAttribute("data-display","0");_.setAttribute("data-display","1")}}}},R={pointerFine:window.matchMedia("(pointer: fine)")};window.addEventListener("DOMContentLoaded",function(){const k={templateCollection:document.getElementById("template_collection"),templateCollSkeleton:document.getElementById("template_collection-skeleton"),templateCollItem:document.getElementById("template_collection-item"),templateIcons:document.getElementById("template_icons"),headerButtonNav:document.getElementById("header_button-nav"),headerNav:document.getElementById("header_nav"),headerButtonSearch:document.getElementById("header_button-search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),hero:document.getElementById("hero"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more")};if(k.templateCollection===null)throw Error("DOM.templateCollection is null");if(k.templateCollSkeleton===null)throw Error("DOM.templateCollSkeleton is null");if(k.templateCollItem===null)throw Error("DOM.templateCollItem is null");if(k.templateIcons===null)throw Error("DOM.templateIcons is null");if(k.headerButtonNav===null)throw Error("DOM.headerButtonNav is null");if(k.headerNav===null)throw Error("DOM.headerNav is null");if(k.headerButtonSearch===null)throw Error("DOM.headerButtonSearch is null");if(k.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(k.main===null)throw Error("DOM.main is null");if(k.hero===null)throw Error("DOM.hero is null");if(k.view===null)throw Error("DOM.view is null");if(k.buttonMore===null)throw Error("DOM.buttonMore is null");if(w.init(),k.headerButtonTheme.setAttribute("data-type",w.current),k.headerButtonTheme.addEventListener("click",w.onclick),k.headerButtonNav.addEventListener("click",F.buttonNavOnclick),k.headerNav.addEventListener("focusout",F.navOnfocusout),k.headerNav.addEventListener("click",F.navOnclick),R.pointerFine.matches)k.view.onclick=f.onclick;R.pointerFine.onchange=function(_){if(_.matches)k.view.onclick=f.onclick;else k.view.onclick=null};const u=K.getTrending("1");u.then(console.info);const U=u.then(x.selectHero);U.then(console.info),U.then(x.getHeroLogo).then(function(_){if(_!==void 0)x.initDOMImgLogo(_,k.hero)}),U.then(function(_){if(_!==void 0)x.initDOM(_,k.hero)}),u.then(function(_){if(_?.results===void 0||_.results.length===0)throw Error("API.getTrending does not have data");let q=Z("Week Trendings",_.results,void 0,k.templateCollection,k.templateCollItem,k.templateIcons);const b=k.view.children[0];b.insertAdjacentElement("beforebegin",q),b.remove()}),K.getPopular("movie","1").then(function(_){if(console.info("getPopular movie",_),_?.results===void 0||_.results.length===0)throw Error("API.getDiscover does not have data");let q=Z("Popular Movies",_.results,"movie",k.templateCollection,k.templateCollItem,k.templateIcons);const b=k.view.children[1];b.insertAdjacentElement("beforebegin",q),b.remove()}),K.getPopular("tv","1").then(function(_){if(console.info("getPopular tv",_),_?.results===void 0||_.results.length===0)throw Error("API.getDiscover does not have data");let q=Z("Popular Tv series",_.results,"tv",k.templateCollection,k.templateCollItem,k.templateIcons);const b=k.view.children[2];b.insertAdjacentElement("beforebegin",q),b.remove()}),K.getTopRated("movie","1").then(function(_){if(console.info("getTopRate movie",_),_?.results===void 0||_.results.length===0)throw Error("API.getTopRated does not have data");let q=Z("Top rated movie",_.results,"movie",k.templateCollection,k.templateCollItem,k.templateIcons);const b=k.view.children[3];b.insertAdjacentElement("beforebegin",q),b.remove()}),K.getTopRated("tv","1").then(function(_){if(console.info("getTopRate tv",_),_?.results===void 0||_.results.length===0)throw Error("API.getTopRated does not have data");let q=Z("Top rated tv serie",_.results,"tv",k.templateCollection,k.templateCollItem,k.templateIcons);const b=k.view.children[4];b.insertAdjacentElement("beforebegin",q),b.remove()});const $=K.getGenres("movie"),E=K.getGenres("tv");Promise.all([$,E]).then(function(_){if(console.info("movie genres",_[0]),console.info("tv genres",_[1]),_[0]===void 0||_[0].genres===void 0||_[0].genres.length===0)throw Error("API.getGenre does not have data");if(_[1]===void 0||_[1].genres===void 0||_[1].genres.length===0)throw Error("API.getGenre does not have data");L.genresMax=_[0].genres.length+_[1].genres.length;for(let q=0;q<2;q+=1){let b,j,Q,W;if(Math.random()<0.5){let z=_[0].genres;const J=Math.floor(Math.random()*z.length);j=z[J].id,Q=z[J].name,b="movie",W=`${Q} Tv series`}else{let z=_[1].genres;const J=Math.floor(Math.random()*z.length);j=z[J].id,Q=z[J].name,b="tv",W=`${Q} Movies`}K.getDiscover(b,j).then(function(z){if(console.info(j,z),z?.results===void 0||z.results.length===0)throw Error("API.getTopRated does not have data");let J=Z(W,z.results,b,k.templateCollection,k.templateCollItem,k.templateIcons);const V=k.view.children[5+q];V.insertAdjacentElement("beforebegin",J),V.remove()})}})});
