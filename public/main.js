import h from"./general.js";var J=function(w){var H,W,j,x,u=I.movieGenres,b=I.tvGenres,B=I.itv,E=I.imov,X=0;w.buttonMore?.setAttribute("data-display","0");var f=0,q=!1;if(I.count+I.STEPS<I.len)f=I.count+I.STEPS;else f=I.len,q=!0;for(var A=I.count;A<f;A+=1){var z=w.templateCollection.content.children[0].cloneNode(!0);w.view?.appendChild(z)}for(var A=I.count;A<f;A+=1){if(B<b.length&&E<u.length){if(Math.random()<0.5)X=1}else if(tv<b.length)X=1;if(X===0)W=u[E].id,j=u[E].name,H="movie",x=`${j} Movies`,E+=1,I.imov+=1;else W=b[B].id,j=b[B].name,H="tv",x=`${j} Tv series`,B+=1,I.itv+=1;I.count+=1,h.View.discover(h.API.getDiscover(H,W,"1"),x,H,A,w.view.children.length-f,w)}if(!q)w.buttonMore?.setAttribute("data-display","1")},I={MAX:15,STEPS:5,len:0,count:7,itv:0,tvGenres:null,imov:0,movieGenres:null};window.addEventListener("DOMContentLoaded",function(){var w={templateCollection:document.getElementById("template_collection"),templateModal:document.getElementById("template_modal"),headerButtonNav:document.getElementById("header_button-nav"),headerNav:document.getElementById("header_nav"),headerButtonSearch:document.getElementById("header_button-search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),hero:document.getElementById("hero"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(w.templateCollection===null)throw Error("DOM.templateCollection is null");if(w.templateModal===null)throw Error("DOM.templateModal is null");if(w.headerButtonNav===null)throw Error("DOM.headerButtonNav is null");if(w.headerNav===null)throw Error("DOM.headerNav is null");if(w.headerButtonSearch===null)throw Error("DOM.headerButtonSearch is null");if(w.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(w.main===null)throw Error("DOM.main is null");if(w.hero===null)throw Error("DOM.hero is null");if(w.view===null)throw Error("DOM.view is null");if(w.buttonMore===null)throw Error("DOM.buttonMore is null");if(w.modal===null)throw Error("DOM.modal is null");h.Theme.init(),h.Route.init(w),window.addEventListener("popstate",function(){h.Route.onpopstate(w)}),w.headerButtonTheme.setAttribute("data-type",h.Theme.current),w.headerButtonTheme.addEventListener("click",h.Theme.onclick),w.headerButtonNav.addEventListener("click",h.Nav.buttonNavOnclick),w.headerNav.addEventListener("focusout",h.Nav.navOnfocusout),w.view.addEventListener("click",function(u){h.View.onclick(u.target,w)}),w.hero.lastElementChild.addEventListener("click",function(u){h.Hero.DOMTitleOnclick(u.target,w)}),w.modal.addEventListener("click",function(u){h.Modal.onclick(u.target,w)}),w.modal.addEventListener("change",function(u){h.Modal.onchange(u.target,w)}),w.buttonMore.addEventListener("click",function(u){J(w)});var H=h.API.getTrending("all","1");H.then(function(u){console.info("trending: ",u)});var W=H.then(h.Hero.selectHero);W.then(function(u){console.info("hero: ",u)}),W.then(h.Hero.getHeroLogo).then(function(u){h.Hero.initDOMImgLogo(u,w.hero)}),W.then(function(u){if(u!==void 0)h.Hero.initDOM(u,w.hero)}),H.then(function(u){if(u?.results===void 0||u.results.length===0)throw Error("API.getTrending does not have data");var b=h.View.createDOMCollection("Week Trendings",u.results,void 0,w.templateCollection.content),B=w.view.children[0];B.insertAdjacentElement("beforebegin",b),B.remove()}),h.API.getPopular("movie","1").then(function(u){if(console.info("getPopular movie",u),u?.results===void 0||u.results.length===0)throw Error("API.getDiscover does not have data");var b=h.View.createDOMCollection("Popular Movies",u.results,"movie",w.templateCollection.content),B=w.view.children[1];B.insertAdjacentElement("beforebegin",b),B.remove()}),h.API.getPopular("tv","1").then(function(u){if(console.info("getPopular tv",u),u?.results===void 0||u.results.length===0)throw Error("API.getDiscover does not have data");var b=h.View.createDOMCollection("Popular Tv series",u.results,"tv",w.templateCollection.content),B=w.view.children[2];B.insertAdjacentElement("beforebegin",b),B.remove()}),h.API.getTopRated("movie","1").then(function(u){if(console.info("getTopRate movie",u),u?.results===void 0||u.results.length===0)throw Error("API.getTopRated does not have data");var b=h.View.createDOMCollection("Top rated movie",u.results,"movie",w.templateCollection.content),B=w.view.children[3];B.insertAdjacentElement("beforebegin",b),B.remove()}),h.API.getTopRated("tv","1").then(function(u){if(console.info("getTopRate tv",u),u?.results===void 0||u.results.length===0)throw Error("API.getTopRated does not have data");var b=h.View.createDOMCollection("Top rated tv serie",u.results,"tv",w.templateCollection.content),B=w.view.children[4];B.insertAdjacentElement("beforebegin",b),B.remove()});var j=h.API.getGenres("movie"),x=h.API.getGenres("tv");Promise.all([j,x]).then(function(u){if(console.info("movie genres",u[0]),console.info("tv genres",u[1]),u[0]===void 0||u[0].genres===void 0||u[0].genres.length===0)throw Error("API.getGenre does not have data");if(u[1]===void 0||u[1].genres===void 0||u[1].genres.length===0)throw Error("API.getGenre does not have data");var b=u[0].genres,B=u[1].genres;if(I.tvGenres=B,I.movieGenres=b,b.length+B.length<I.MAX)I.len=b.length+B.length;else I.len=I.MAX;if(console.info("Collection:",I),w.buttonMore?.setAttribute("data-display","1"),b.length>1)h.Utils.randomPermutation(b);if(B.length>1)h.Utils.randomPermutation(B);var E,X,f,q,A=0,z=0;for(let F=0;F<2;F+=1){if(Math.random()<0.5)X=b[A].id,f=b[A].name,E="movie",q=`${f} Movies`,A+=1,I.imov+=1;else X=B[z].id,f=B[z].name,E="tv",q=`${f} Tv series`,z+=1,I.itv+=1;h.View.discover(h.API.getDiscover(E,X,"1"),q,E,F,5,w)}})});
