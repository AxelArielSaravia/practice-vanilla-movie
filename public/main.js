import b from"./general.js";import I from"./collection.js";var R=function(E){var w,x,A,J,f=h.movieGenres,B=h.tvGenres,u=h.itv,q=h.imov,z=0;E.buttonMore?.setAttribute("data-display","0");var U=0,H=!1;if(h.count+h.STEPS<h.len)U=h.count+h.STEPS;else U=h.len,H=!0;for(var X=h.count;X<U;X+=1){var K=E.templateCollection.content.children[0].cloneNode(!0);E.view?.appendChild(K)}for(var X=h.count;X<U;X+=1){if(u<B.length&&q<f.length){if(Math.random()<0.5)z=1}else if(tv<B.length)z=1;if(z===0)x=f[q].id,A=f[q].name,w="movie",J=`${A} Movies`,q+=1,h.imov+=1;else x=B[u].id,A=B[u].name,w="tv",J=`${A} Tv Series`,u+=1,h.itv+=1;h.count+=1,I.View.discover(b.API.getDiscover(w,"1",x,void 0,void 0,void 0),J,w,x,X,E.view.children.length-U,E)}if(!H)E.buttonMore?.setAttribute("data-display","1")},h={MAX:15,STEPS:5,len:0,count:7,itv:0,tvGenres:null,imov:0,movieGenres:null};window.addEventListener("DOMContentLoaded",function(){var E={templateCollection:document.getElementById("template_collection"),templateModal:document.getElementById("template_modal"),headerPNav:document.getElementById("header_p_nav"),headerSearch:document.getElementById("header_search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),hero:document.getElementById("hero"),heroTitle:document.getElementById("hero-title"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(E.templateCollection===null)throw Error("DOM.templateCollection is null");if(E.templateModal===null)throw Error("DOM.templateModal is null");if(E.headerPNav===null)throw Error("DOM.headerPNav is null");if(E.headerSearch===null)throw Error("DOM.headerSearch is null");if(E.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(E.main===null)throw Error("DOM.main is null");if(E.hero===null)throw Error("DOM.hero is null");if(E.heroTitle===null)throw Error("DOM.heroTitle is null");if(E.view===null)throw Error("DOM.view is null");if(E.buttonMore===null)throw Error("DOM.buttonMore is null");if(E.modal===null)throw Error("DOM.modal is null");b.Theme.init(),b.Route.init(E),window.addEventListener("popstate",function(){b.Route.onpopstate(E)}),E.headerButtonTheme.setAttribute("data-type",b.Theme.current),E.headerButtonTheme.addEventListener("click",b.Theme.onclick),E.headerPNav.firstElementChild.addEventListener("click",b.Nav.buttonNavOnclick),E.headerPNav.lastElementChild.addEventListener("focusout",b.Nav.navOnfocusout),E.headerSearch.children[1].addEventListener("click",function(f){E.headerSearch.reset()}),E.view.addEventListener("click",function(f){I.View.onclick(f.target,E,f)}),E.heroTitle.addEventListener("click",function(f){b.Hero.DOMTitleOnclick(f.target,E,f)}),E.modal.addEventListener("click",function(f){b.Modal.onclick(f.target,E)}),E.modal.addEventListener("change",function(f){b.Modal.onchange(f.target,E)}),E.buttonMore.addEventListener("click",function(f){R(E)});var w=b.API.getTrending("all","1");w.then(function(f){console.info("trending: ",f)});var x=w.then(b.Hero.selectHero);x.then(function(f){console.info("hero: ",f)}),x.then(b.Hero.getHeroLogo).then(function(f){b.Hero.initDOMImgLogo(f,E.hero)}),x.then(function(f){if(f!==void 0)b.Hero.initDOM(f,E.hero)}),w.then(function(f){if(f?.results===void 0||f.results.length===0)throw Error("API.getTrending does not have data");var B=I.Collection.createDOMCollection("Week Trendings",f.results,"all",I.Collection.TRENDING,void 0,E.templateCollection.content),u=E.view.children[0];u.insertAdjacentElement("beforebegin",B),u.remove()}),b.API.getPopular("movie","1").then(function(f){if(console.info("getPopular movie",f),f?.results===void 0||f.results.length===0)throw Error("API.getDiscover does not have data");var B=I.Collection.createDOMCollection("Popular Movies",f.results,"movie",I.Collection.POPULAR,void 0,E.templateCollection.content),u=E.view.children[1];u.insertAdjacentElement("beforebegin",B),u.remove()}),b.API.getPopular("tv","1").then(function(f){if(console.info("getPopular tv",f),f?.results===void 0||f.results.length===0)throw Error("API.getDiscover does not have data");var B=I.Collection.createDOMCollection("Popular Tv Series",f.results,"tv",I.Collection.POPULAR,void 0,E.templateCollection.content),u=E.view.children[2];u.insertAdjacentElement("beforebegin",B),u.remove()}),b.API.getTopRated("movie","1").then(function(f){if(console.info("getTopRate movie",f),f?.results===void 0||f.results.length===0)throw Error("API.getTopRated does not have data");var B=I.Collection.createDOMCollection("Top Rated Movie",f.results,"movie",I.Collection.TOP_RATED,void 0,E.templateCollection.content),u=E.view.children[3];u.insertAdjacentElement("beforebegin",B),u.remove()}),b.API.getTopRated("tv","1").then(function(f){if(console.info("getTopRate tv",f),f?.results===void 0||f.results.length===0)throw Error("API.getTopRated does not have data");var B=I.Collection.createDOMCollection("Top Rated Tv Serie",f.results,"tv",I.Collection.TOP_RATED,void 0,E.templateCollection.content),u=E.view.children[4];u.insertAdjacentElement("beforebegin",B),u.remove()});var A=b.API.getGenres("movie"),J=b.API.getGenres("tv");Promise.all([A,J]).then(function(f){if(console.info("movie genres",f[0]),console.info("tv genres",f[1]),f[0]===void 0||f[0].genres===void 0||f[0].genres.length===0)throw Error("API.getGenre does not have data");if(f[1]===void 0||f[1].genres===void 0||f[1].genres.length===0)throw Error("API.getGenre does not have data");var B=f[0].genres,u=f[1].genres;if(h.tvGenres=u,h.movieGenres=B,B.length+u.length<h.MAX)h.len=B.length+u.length;else h.len=h.MAX;if(console.info("Collection:",h),E.buttonMore?.setAttribute("data-display","1"),B.length>1)b.Utils.randomPermutation(B);if(u.length>1)b.Utils.randomPermutation(u);var q,z,U,H,X=0,K=0;for(let Q=0;Q<2;Q+=1){if(Math.random()<0.5)z=B[X].id,U=B[X].name,q="movie",H=`${U} Movies`,X+=1,h.imov+=1;else z=u[K].id,U=u[K].name,q="tv",H=`${U} Tv Series`,K+=1,h.itv+=1;I.View.discover(b.API.getDiscover(q,"1",z,void 0,void 0,void 0),H,q,z,Q,5,E)}})});
