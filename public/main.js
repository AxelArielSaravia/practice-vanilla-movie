import I from"./general.js";import X from"./collection.js";var U=function(u){var x,z,B,J,E=b.movieGenres,R=b.tvGenres,h=b.itv,w=b.imov,A=0;u.buttonMore?.setAttribute("data-display","0");var f=0,H=!1;if(b.count+b.STEPS<b.len)f=b.count+b.STEPS;else f=b.len,H=!0;for(var q=b.count;q<f;q+=1){var K=u.templateCollection.content.children[0].cloneNode(!0);u.view?.appendChild(K)}for(var q=b.count;q<f;q+=1){if(h<R.length&&w<E.length){if(Math.random()<0.5)A=1}else if(tv<R.length)A=1;if(A===0)z=E[w].id,B=E[w].name,x="movie",J=`${B} Movies`,w+=1,b.imov+=1;else z=R[h].id,B=R[h].name,x="tv",J=`${B} Tv Series`,h+=1,b.itv+=1;b.count+=1,X.View.discover(I.API.getDiscover(x,"1",z,void 0,void 0,void 0),J,x,z,q,u.view.children.length-f,u)}if(!H)u.buttonMore?.setAttribute("data-display","1")},b={MAX:15,STEPS:5,len:0,count:7,itv:0,tvGenres:null,imov:0,movieGenres:null};window.addEventListener("DOMContentLoaded",function(){var u={templateCollection:document.getElementById("template_collection"),templateModal:document.getElementById("template_modal"),headerPNav:document.getElementById("header_p_nav"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),hero:document.getElementById("hero"),heroTitle:document.getElementById("hero-title"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(u.templateCollection===null)throw Error("DOM.templateCollection is null");if(u.templateModal===null)throw Error("DOM.templateModal is null");if(u.headerPNav===null)throw Error("DOM.headerPNav is null");if(u.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(u.main===null)throw Error("DOM.main is null");if(u.hero===null)throw Error("DOM.hero is null");if(u.heroTitle===null)throw Error("DOM.heroTitle is null");if(u.view===null)throw Error("DOM.view is null");if(u.buttonMore===null)throw Error("DOM.buttonMore is null");if(u.modal===null)throw Error("DOM.modal is null");I.Theme.init(),I.Route.init(u),window.addEventListener("popstate",function(){I.Route.onpopstate(u)}),u.headerButtonTheme.setAttribute("data-type",I.Theme.current),u.headerButtonTheme.addEventListener("click",I.Theme.onclick),u.headerPNav.firstElementChild.addEventListener("click",I.Nav.buttonNavOnclick),u.headerPNav.lastElementChild.addEventListener("focusout",I.Nav.navOnfocusout),u.view.addEventListener("click",function(E){X.View.onclick(E.target,u,E)}),u.heroTitle.addEventListener("click",function(E){I.Hero.DOMTitleOnclick(E.target,u,E)}),u.modal.addEventListener("click",function(E){I.Modal.onclick(E.target,u)}),u.modal.addEventListener("change",function(E){I.Modal.onchange(E.target,u)}),u.buttonMore.addEventListener("click",function(E){U(u)});var x=I.API.getTrending("all","1");x.then(function(E){console.info("trending: ",E)});var z=x.then(I.Hero.selectHero);z.then(function(E){console.info("hero: ",E)}),z.then(I.Hero.getHeroLogo).then(function(E){I.Hero.initDOMImgLogo(E,u.hero)}),z.then(function(E){if(E!==void 0)I.Hero.initDOM(E,u.hero)}),x.then(function(E){if(E?.results===void 0||E.results.length===0)throw Error("API.getTrending does not have data");var R=X.Collection.createDOMCollection("Week Trendings",E.results,"all",X.Collection.TRENDING,void 0,u.templateCollection.content),h=u.view.children[0];h.insertAdjacentElement("beforebegin",R),h.remove()}),I.API.getPopular("movie","1").then(function(E){if(console.info("getPopular movie",E),E?.results===void 0||E.results.length===0)throw Error("API.getDiscover does not have data");var R=X.Collection.createDOMCollection("Popular Movies",E.results,"movie",X.Collection.POPULAR,void 0,u.templateCollection.content),h=u.view.children[1];h.insertAdjacentElement("beforebegin",R),h.remove()}),I.API.getPopular("tv","1").then(function(E){if(console.info("getPopular tv",E),E?.results===void 0||E.results.length===0)throw Error("API.getDiscover does not have data");var R=X.Collection.createDOMCollection("Popular Tv Series",E.results,"tv",X.Collection.POPULAR,void 0,u.templateCollection.content),h=u.view.children[2];h.insertAdjacentElement("beforebegin",R),h.remove()}),I.API.getTopRated("movie","1").then(function(E){if(console.info("getTopRate movie",E),E?.results===void 0||E.results.length===0)throw Error("API.getTopRated does not have data");var R=X.Collection.createDOMCollection("Top Rated Movie",E.results,"movie",X.Collection.TOP_RATED,void 0,u.templateCollection.content),h=u.view.children[3];h.insertAdjacentElement("beforebegin",R),h.remove()}),I.API.getTopRated("tv","1").then(function(E){if(console.info("getTopRate tv",E),E?.results===void 0||E.results.length===0)throw Error("API.getTopRated does not have data");var R=X.Collection.createDOMCollection("Top Rated Tv Serie",E.results,"tv",X.Collection.TOP_RATED,void 0,u.templateCollection.content),h=u.view.children[4];h.insertAdjacentElement("beforebegin",R),h.remove()});var B=I.API.getGenres("movie"),J=I.API.getGenres("tv");Promise.all([B,J]).then(function(E){if(console.info("movie genres",E[0]),console.info("tv genres",E[1]),E[0]===void 0||E[0].genres===void 0||E[0].genres.length===0)throw Error("API.getGenre does not have data");if(E[1]===void 0||E[1].genres===void 0||E[1].genres.length===0)throw Error("API.getGenre does not have data");var R=E[0].genres,h=E[1].genres;if(b.tvGenres=h,b.movieGenres=R,R.length+h.length<b.MAX)b.len=R.length+h.length;else b.len=b.MAX;if(console.info("Collection:",b),u.buttonMore?.setAttribute("data-display","1"),R.length>1)I.Utils.randomPermutation(R);if(h.length>1)I.Utils.randomPermutation(h);var w,A,f,H,q=0,K=0;for(let Q=0;Q<2;Q+=1){if(Math.random()<0.5)A=R[q].id,f=R[q].name,w="movie",H=`${f} Movies`,q+=1,b.imov+=1;else A=h[K].id,f=h[K].name,w="tv",H=`${f} Tv Series`,K+=1,b.itv+=1;X.View.discover(I.API.getDiscover(w,"1",A,void 0,void 0,void 0),H,w,A,Q,5,u)}})});
