var b=function(E){if(E.ok)return E.json()};var L={getTrending(E="1"){return fetch(`${window.location.origin}/api/trending?page=${E}`).then(b)},getPopular(E,x="1"){return fetch(`${window.location.origin}/api/popular?type=${E}&page=${x}`).then(b)},getDiscover(E,x,K="1"){var $=`${window.location.origin}/api/discover?type=${E}&page=${K}`;if(x!==void 0)$=`${$}&genre=${x}`;return fetch($).then(b)},getImages(E,x){return fetch(`${window.location.origin}/api/images?type=${x}&id=${E}`).then(b)},getGenres(E){return fetch(`${window.location.origin}/api/genres?type=${E}`).then(b)},getTopRated(E,x="1"){return fetch(`${window.location.origin}/api/toprated?type=${E}&page=${x}`).then(b)}},X=L;var u=function(E){return Math.floor(Math.random()*E)},j=function(E){var x=E.length;for(var K=0;K<x-1;K+=1){var $=K+Math.floor(Math.random()*(x-K)),q=E[K];E[K]=E[$],E[$]=q}};async function A(E,x,K,$){var q=await E;if(q===void 0||q.backdrops===void 0||q.backdrops.length===0)if($!==void 0&&$.length>0){var _=x.lastElementChild;_.setAttribute("src",`https://image.tmdb.org/t/p/w400${$}`),_.setAttribute("data-display","1")}else{x.firstElementChild.setAttribute("data-display","1");var z=K.content.firstElementChild?.cloneNode(!0);x.appendChild(z)}else{var U=q.backdrops[0],_=x.lastElementChild;_.setAttribute("src",`https://image.tmdb.org/t/p/w400${U.file_path}`),_.setAttribute("data-display","1")}}var f=function(E,x,K,$,q,_){var z=$.content.cloneNode(!0),U=z.firstElementChild,Y=U.children[0];Y.insertAdjacentText("beforeend",E);for(var Z of x){const W=q.content.cloneNode(!0).firstElementChild;W.setAttribute("data-id",Z.id);let w,Q;if(K!==void 0)Q=K;else Q=Z.media_type;if(Q==="movie")w=Z.title;else w=Z.name;W.setAttribute("title",w),W.firstElementChild.insertAdjacentText("beforeend",w),W.lastElementChild.setAttribute("alt",w),A(X.getImages(Z.id,Q),W,_,Z.backdrop_path),U.lastElementChild.appendChild(W)}return U};async function S(E,x,K,$,q){var _=await E;if(console.info(x,_),_?.results===void 0||_.results.length===0)throw Error("API.getTopRated does not have data");var z=f(x,_.results,K,q.templateCollection,q.templateCollItem,q.templateIcons),U=q.view.children[5+$];U.insertAdjacentElement("beforebegin",z),U.remove()}var R={NAV_LINK:"0",COLL_TITLE:"4",COLL_BUTTON:"5"},B={MAX:20,genresMax:0,count:7},H={pointerFine:window.matchMedia("(pointer: fine)")},F={current:"dark",DARK:"dark",LIGHT:"light",init(){var E=localStorage.getItem("theme");if(E==="dark"||E==="light")F.current=E;else{if(window.matchMedia!==void 0&&window.matchMedia("(prefers-color-scheme: dark)").matches)F.current=F.DARK;else F.current=F.LIGHT;localStorage.setItem("theme",F.current)}document.firstElementChild?.setAttribute("class",F.current)},change(E){localStorage.setItem("theme",E),document.firstElementChild?.setAttribute("class",F.current)},onclick(E){var x=E.currentTarget;if(x===null)return;if(F.current===F.DARK)F.current=F.LIGHT;else F.current=F.DARK;x.setAttribute("data-type",F.current),F.change(F.current)}},J={ATTR_SHOW:"data-mbshow",ATTR_SELECTED:"data-selected",ATTR_LINK_TYPE:"data-linkt",HIDDEN:"0",SHOW:"1",buttonNavOnclick(E){console.info(E);var x=E.currentTarget,K=x.nextElementSibling;if(K.getAttribute(J.ATTR_SHOW)===J.HIDDEN)K.setAttribute(J.ATTR_SHOW,J.SHOW),K.firstElementChild.firstElementChild.focus();else K.setAttribute(J.ATTR_SHOW,J.HIDDEN)},navOnfocusout(E){var x=E.relatedTarget;if(x===null||x.getAttribute("data-type")!==R.NAV_LINK){var K=E.currentTarget;K.setAttribute(J.ATTR_SHOW,J.HIDDEN)}},navOnclick(E){var x=E.target;if(x.getAttribute("data-type")===R.NAV_LINK){var K=x.getAttribute(J.ATTR_LINK_TYPE),$=E.currentTarget,q=$.previousElementSibling;q.replaceChildren(),q.insertAdjacentText("beforeend",x.textContent),$.setAttribute(J.ATTR_SHOW,J.HIDDEN),$.setAttribute(J.ATTR_SELECTED,K),E.preventDefault()}}},V={select(E){return E[u(E.length)]},selectHero(E){if(E){if(!E.results||E.results.length===0)throw Error("trending.results does not have data");return V.select(E.results)}},async getHeroLogo(E){if(E===void 0)return;var{id:x,media_type:K}=E,$=await X.getImages(x,K);if($.logos.length>0)return $.logos[0].file_path;else return},initDOMImgLogo(E,x){var K=x.lastElementChild.firstElementChild;if(E)K.lastElementChild.setAttribute("data-display","1"),K.lastElementChild.setAttribute("src",`https://image.tmdb.org/t/p/w300${E}`);else K.firstElementChild.setAttribute("data-display","1")},initDOM(E,x){var K=x.firstElementChild.firstElementChild,$=x.lastElementChild,q=$.firstElementChild.firstElementChild,_=$.children[2];K.setAttribute("data-display","1"),K.setAttribute("src",`https://image.tmdb.org/t/p/w1280${E.backdrop_path}`),q.textContent=E.title,_.textContent=E.overview}},k={TYPE_SBUTTON:"data-sbuttont",onclick(E){var x=E.target;if(x?.getAttribute("data-type")===R.COLL_BUTTON){var K=x.parentElement.lastElementChild;const _=x.parentElement.children[1],z=x.parentElement.children[2];var $=x.getAttribute(k.TYPE_SBUTTON),q=K.clientWidth-K.clientWidth*6/100;if(K.scrollLeft-q<=0)_.setAttribute("data-display","0");else _.setAttribute("data-display","1");if($==="0"){if(K.scrollBy(-q,0),K.scrollLeft-q<=0)_.setAttribute("data-display","0");z.setAttribute("data-display","1")}else{if(K.scrollBy(q,0),K.scrollLeft+q>=K.scrollWidth-K.clientWidth)z.setAttribute("data-display","0");_.setAttribute("data-display","1")}}}};window.addEventListener("DOMContentLoaded",function(){var E={templateCollection:document.getElementById("template_collection"),templateCollSkeleton:document.getElementById("template_collection-skeleton"),templateCollItem:document.getElementById("template_collection-item"),templateIcons:document.getElementById("template_icons"),headerButtonNav:document.getElementById("header_button-nav"),headerNav:document.getElementById("header_nav"),headerButtonSearch:document.getElementById("header_button-search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),hero:document.getElementById("hero"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more")};if(E.templateCollection===null)throw Error("DOM.templateCollection is null");if(E.templateCollSkeleton===null)throw Error("DOM.templateCollSkeleton is null");if(E.templateCollItem===null)throw Error("DOM.templateCollItem is null");if(E.templateIcons===null)throw Error("DOM.templateIcons is null");if(E.headerButtonNav===null)throw Error("DOM.headerButtonNav is null");if(E.headerNav===null)throw Error("DOM.headerNav is null");if(E.headerButtonSearch===null)throw Error("DOM.headerButtonSearch is null");if(E.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(E.main===null)throw Error("DOM.main is null");if(E.hero===null)throw Error("DOM.hero is null");if(E.view===null)throw Error("DOM.view is null");if(E.buttonMore===null)throw Error("DOM.buttonMore is null");if(F.init(),E.headerButtonTheme.setAttribute("data-type",F.current),E.headerButtonTheme.addEventListener("click",F.onclick),E.headerButtonNav.addEventListener("click",J.buttonNavOnclick),E.headerNav.addEventListener("focusout",J.navOnfocusout),E.headerNav.addEventListener("click",J.navOnclick),H.pointerFine.matches)E.view.onclick=k.onclick;H.pointerFine.onchange=function(_){if(_.matches)E.view.onclick=k.onclick;else E.view.onclick=null};var x=X.getTrending("1");x.then(function(_){console.info("trending: ",_)});var K=x.then(V.selectHero);K.then(function(_){console.info("hero: ",_)}),K.then(V.getHeroLogo).then(function(_){if(_!==void 0)V.initDOMImgLogo(_,E.hero)}),K.then(function(_){if(_!==void 0)V.initDOM(_,E.hero)}),x.then(function(_){if(_?.results===void 0||_.results.length===0)throw Error("API.getTrending does not have data");var z=f("Week Trendings",_.results,void 0,E.templateCollection,E.templateCollItem,E.templateIcons),U=E.view.children[0];U.insertAdjacentElement("beforebegin",z),U.remove()}),X.getPopular("movie","1").then(function(_){if(console.info("getPopular movie",_),_?.results===void 0||_.results.length===0)throw Error("API.getDiscover does not have data");var z=f("Popular Movies",_.results,"movie",E.templateCollection,E.templateCollItem,E.templateIcons),U=E.view.children[1];U.insertAdjacentElement("beforebegin",z),U.remove()}),X.getPopular("tv","1").then(function(_){if(console.info("getPopular tv",_),_?.results===void 0||_.results.length===0)throw Error("API.getDiscover does not have data");var z=f("Popular Tv series",_.results,"tv",E.templateCollection,E.templateCollItem,E.templateIcons),U=E.view.children[2];U.insertAdjacentElement("beforebegin",z),U.remove()}),X.getTopRated("movie","1").then(function(_){if(console.info("getTopRate movie",_),_?.results===void 0||_.results.length===0)throw Error("API.getTopRated does not have data");var z=f("Top rated movie",_.results,"movie",E.templateCollection,E.templateCollItem,E.templateIcons),U=E.view.children[3];U.insertAdjacentElement("beforebegin",z),U.remove()}),X.getTopRated("tv","1").then(function(_){if(console.info("getTopRate tv",_),_?.results===void 0||_.results.length===0)throw Error("API.getTopRated does not have data");var z=f("Top rated tv serie",_.results,"tv",E.templateCollection,E.templateCollItem,E.templateIcons),U=E.view.children[4];U.insertAdjacentElement("beforebegin",z),U.remove()});var $=X.getGenres("movie"),q=X.getGenres("tv");Promise.all([$,q]).then(function(_){if(console.info("movie genres",_[0]),console.info("tv genres",_[1]),_[0]===void 0||_[0].genres===void 0||_[0].genres.length===0)throw Error("API.getGenre does not have data");if(_[1]===void 0||_[1].genres===void 0||_[1].genres.length===0)throw Error("API.getGenre does not have data");var z=_[0].genres,U=_[1].genres;if(B.genresMax=z.length+U.length,z.length>1)j(z);if(U.length>1)j(U);var Y,Z,W,w;for(let Q=0;Q<2;Q+=1){if(Math.random()<0.5)Z=z[Q].id,W=z[Q].name,Y="movie",w=`${W} Tv series`;else Z=U[Q].id,W=U[Q].name,Y="tv",w=`${W} Movies`;S(X.getDiscover(Y,Z,"1"),w,Y,Q,E)}})});
