import t from"../general.js";async function p(e,m,n){var i;try{i=await e}catch{l.ended=!0,DocumentFragment.prototype.replaceChildren.apply(n.templateSkeleton.content,a);return}if(i?.results===void 0||i.results.length===0){l.ended=!0,DocumentFragment.prototype.replaceChildren.apply(n.templateSkeleton.content,a);return}var d;for(var r of i.results)d=t.Item.createDOMItem(r,m,n.templateItem?.content?.firstElementChild),l.fragment.appendChild(d);DocumentFragment.prototype.replaceChildren.apply(n.templateSkeleton.content,a),n.view.appendChild(l.fragment),n.buttonMore.setAttribute("data-display","1")}var l={fragment:document.createDocumentFragment(),maxPages:0,page:1,ended:!1},a=Array(6);window.addEventListener("DOMContentLoaded",function(){var e={templateSkeleton:document.getElementById("template_skeleton"),templateItem:document.getElementById("template_item"),templateModal:document.getElementById("template_modal"),headerPNav:document.getElementById("header_p_nav"),headerSearch:document.getElementById("header_search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(e.templateSkeleton===null)throw Error("DOM.templateSkeleton is null");if(e.templateItem===null)throw Error("DOM.templateItem is null");if(e.templateModal===null)throw Error("DOM.templateModal is null");if(e.headerPNav===null)throw Error("DOM.headerPNav is null");if(e.headerSearch===null)throw Error("DOM.headerSearch is null");if(e.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(e.main===null)throw Error("DOM.main is null");if(e.view===null)throw Error("DOM.view is null");if(e.buttonMore===null)throw Error("DOM.buttonMore is null");if(e.modal===null)throw Error("DOM.modal is null");t.Route.url.href=window.location.href;var m=t.Route.url,n=m.searchParams.get(t.Route.Q_MEDIA_TYPE);if(n==="tv")e.main.firstElementChild.textContent+=" Tv Series";else if(n==="movie")e.main.firstElementChild.textContent+=" Movies";else{window.open("./404.html","_self","noopener,noreferrer");return}a[0]=e.view.children[0],a[1]=e.view.children[1],a[2]=e.view.children[2],a[3]=e.view.children[3],a[4]=e.view.children[4],a[5]=e.view.children[5],t.Theme.init(),t.Route.href=`${t.Route.href}?${t.Route.Q_MEDIA_TYPE}=${n}`,t.Route.init(e),window.addEventListener("popstate",function(){t.Route.onpopstate(e)}),e.headerButtonTheme.setAttribute("data-type",t.Theme.current),e.headerButtonTheme.addEventListener("click",t.Theme.onclick),e.headerPNav.firstElementChild.addEventListener("click",t.Nav.buttonNavOnclick),e.headerPNav.lastElementChild.addEventListener("focusout",t.Nav.navOnfocusout),e.headerSearch.children[1].addEventListener("click",function(r){e.headerSearch.reset()}),e.buttonMore.addEventListener("click",function(){if(e.buttonMore?.setAttribute("data-display","0"),l.ended)return;e.view.appendChild(e.templateSkeleton.content),p(t.API.getPopular(n,String(l.page)),n,e),l.page+=1}),e.view.addEventListener("click",function(r){var o=r.target,u=o.getAttribute("data-type");if(u===t.TYPE.ITEM){r.preventDefault();var c=o.getAttribute("data-id");if(c!==null)t.Modal.open(n,c,e,!0)}}),e.modal.addEventListener("click",function(r){t.Modal.onclick(r.target,e)}),e.modal.addEventListener("change",function(r){t.Modal.onchange(r.target,e)});var i=t.API.getPopular(n,String(l.page));l.page+=1;var d=t.API.getPopular(n,String(l.page));l.page+=1,i.then(function(r){if(r?.results===void 0||r.results.length===0)l.ended=!0,e.main.children[1].setAttribute("data-display","1");else{var o;for(var u of r.results)o=t.Item.createDOMItem(u,n,e.templateItem?.content?.firstElementChild),l.fragment.appendChild(o)}DocumentFragment.prototype.replaceChildren.apply(e.templateSkeleton.content,a),e.view.appendChild(l.fragment),i=null}),d.then(function(r){if(r?.results===void 0||r.results.length===0){l.ended=!0;return}var o;for(var u of r.results)o=t.Item.createDOMItem(u,n,e.templateItem?.content?.firstElementChild),l.fragment.appendChild(o);e.view.appendChild(l.fragment),e.buttonMore?.setAttribute("data-display","1"),d=null})});
