import v from"../general.js";async function x(c,u,h){var b;try{b=await c}catch{A.ended=!0,DocumentFragment.prototype.replaceChildren.apply(h.templateSkeleton.content,F);return}if(b?.results===void 0||b.results.length===0){A.ended=!0,DocumentFragment.prototype.replaceChildren.apply(h.templateSkeleton.content,F);return}var f;for(var E of b.results)f=v.Item.createDOMItem(E,u,h.templateItem?.content?.firstElementChild),A.fragment.appendChild(f);DocumentFragment.prototype.replaceChildren.apply(h.templateSkeleton.content,F),h.view.appendChild(A.fragment),h.buttonMore.setAttribute("data-display","1")}var A={fragment:document.createDocumentFragment(),maxPages:0,page:1,ended:!1},F=Array(6);window.addEventListener("DOMContentLoaded",function(){var c={templateSkeleton:document.getElementById("template_skeleton"),templateItem:document.getElementById("template_item"),templateModal:document.getElementById("template_modal"),headerPNav:document.getElementById("header_p_nav"),headerSearch:document.getElementById("header_search"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(c.templateSkeleton===null)throw Error("DOM.templateSkeleton is null");if(c.templateItem===null)throw Error("DOM.templateItem is null");if(c.templateModal===null)throw Error("DOM.templateModal is null");if(c.headerPNav===null)throw Error("DOM.headerPNav is null");if(c.headerSearch===null)throw Error("DOM.headerSearch is null");if(c.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(c.main===null)throw Error("DOM.main is null");if(c.view===null)throw Error("DOM.view is null");if(c.buttonMore===null)throw Error("DOM.buttonMore is null");if(c.modal===null)throw Error("DOM.modal is null");v.Route.url.href=window.location.href;var u=v.Route.url,h=u.searchParams.get(v.Route.Q_MEDIA_TYPE);if(h==="tv")c.main.firstElementChild.textContent+=" Tv Series";else if(h==="movie")c.main.firstElementChild.textContent+=" Movies";else throw Error("Bad Route");F[0]=c.view.children[0],F[1]=c.view.children[1],F[2]=c.view.children[2],F[3]=c.view.children[3],F[4]=c.view.children[4],F[5]=c.view.children[5],v.Theme.init(),v.Route.href=`${v.Route.href}?${v.Route.Q_MEDIA_TYPE}=${h}`,v.Route.init(c),window.addEventListener("popstate",function(){v.Route.onpopstate(c)}),c.headerButtonTheme.setAttribute("data-type",v.Theme.current),c.headerButtonTheme.addEventListener("click",v.Theme.onclick),c.headerPNav.firstElementChild.addEventListener("click",v.Nav.buttonNavOnclick),c.headerPNav.lastElementChild.addEventListener("focusout",v.Nav.navOnfocusout),c.headerSearch.children[1].addEventListener("click",function(E){c.headerSearch.reset()}),c.buttonMore.addEventListener("click",function(){if(c.buttonMore?.setAttribute("data-display","0"),A.ended)return;c.view.appendChild(c.templateSkeleton.content),x(v.API.getPopular(h,String(A.page)),h,c),A.page+=1}),c.view.addEventListener("click",function(E){var R=E.target,n=R.getAttribute("data-type");if(n===v.TYPE.ITEM){E.preventDefault();var w=R.getAttribute("data-id");if(w!==null)v.Modal.open(h,w,c,!0)}}),c.modal.addEventListener("click",function(E){v.Modal.onclick(E.target,c)}),c.modal.addEventListener("change",function(E){v.Modal.onchange(E.target,c)});var b=v.API.getPopular(h,String(A.page));A.page+=1;var f=v.API.getPopular(h,String(A.page));A.page+=1,b.then(function(E){if(E?.results===void 0||E.results.length===0)A.ended=!0,c.main.children[1].setAttribute("data-display","1");else{var R;for(var n of E.results)R=v.Item.createDOMItem(n,h,c.templateItem?.content?.firstElementChild),A.fragment.appendChild(R)}DocumentFragment.prototype.replaceChildren.apply(c.templateSkeleton.content,F),c.view.appendChild(A.fragment),b=null}),f.then(function(E){if(E?.results===void 0||E.results.length===0){A.ended=!0;return}var R;for(var n of E.results)R=v.Item.createDOMItem(n,h,c.templateItem?.content?.firstElementChild),A.fragment.appendChild(R);c.view.appendChild(A.fragment),c.buttonMore?.setAttribute("data-display","1"),f=null})});
