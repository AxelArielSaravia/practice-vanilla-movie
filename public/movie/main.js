import p from"../general.js";import q from"../collection.js";var Q=function(I,B,z){var y,f,h,L=w.genres,E=w.index;I.buttonMore?.setAttribute("data-display","0");var A=0,J=!1;if(w.count+B<w.len)A=w.count+B;else A=w.len,J=!0;if(z)for(var K=w.count;K<A;K+=1){var R=I.templateCollection.content.children[0].cloneNode(!0);I.view?.appendChild(R)}var T=I.view.children.length-A,H=w.count;while(H<A)y=L[E].id,f=L[E].name,h=`${f} Movies`,q.View.discover(p.API.getDiscover("movie","1",y,void 0,void 0,void 0),h,"movie",y,H,T,I),E+=1,H+=1;if(w.index=E,w.count=H,!J)I.buttonMore?.setAttribute("data-display","1")},w={STEPS:5,len:0,count:3,index:0,genres:null};window.addEventListener("DOMContentLoaded",function(){var I={templateCollection:document.getElementById("template_collection"),templateModal:document.getElementById("template_modal"),headerPNav:document.getElementById("header_p_nav"),headerButtonTheme:document.getElementById("header_button-theme"),main:document.getElementById("main"),hero:document.getElementById("hero"),heroTitle:document.getElementById("hero-title"),view:document.getElementById("view"),buttonMore:document.getElementById("button-more"),modal:document.getElementById("modal")};if(I.templateCollection===null)throw Error("DOM.templateCollection is null");if(I.templateModal===null)throw Error("DOM.templateModal is null");if(I.headerPNav===null)throw Error("DOM.headerPNav is null");if(I.headerButtonTheme===null)throw Error("DOM.headerButtonTheme is null");if(I.main===null)throw Error("DOM.main is null");if(I.hero===null)throw Error("DOM.hero is null");if(I.heroTitle===null)throw Error("DOM.heroTitle is null");if(I.view===null)throw Error("DOM.view is null");if(I.buttonMore===null)throw Error("DOM.buttonMore is null");if(I.modal===null)throw Error("DOM.modal is null");p.Theme.init(),p.Route.init(I),window.addEventListener("popstate",function(){p.Route.onpopstate(I)}),I.headerButtonTheme.setAttribute("data-type",p.Theme.current),I.headerButtonTheme.addEventListener("click",p.Theme.onclick),I.headerPNav.firstElementChild.addEventListener("click",p.Nav.buttonNavOnclick),I.headerPNav.lastElementChild.addEventListener("focusout",p.Nav.navOnfocusout),I.view.addEventListener("click",function(f){q.View.onclick(f.target,I,f)}),I.heroTitle.addEventListener("click",function(f){p.Hero.DOMTitleOnclick(f.target,I,f)}),I.modal.addEventListener("click",function(f){p.Modal.onclick(f.target,I)}),I.modal.addEventListener("change",function(f){p.Modal.onchange(f.target,I)}),I.buttonMore.addEventListener("click",function(){Q(I,w.STEPS,!0)});var B=p.API.getGenres("movie"),z=p.API.getTrending("movie","1");z.then(function(f){console.info("trending: ",f)});var y=z.then(p.Hero.selectHero);y.then(function(f){console.info("hero: ",f)}),y.then(p.Hero.getHeroLogo).then(function(f){p.Hero.initDOMImgLogo(f,I.hero)}),y.then(function(f){if(f!==void 0)p.Hero.initDOM(f,I.hero)}),z.then(function(f){if(f?.results===void 0||f.results.length===0)throw Error("API.getTrending does not have data");var h=q.Collection.createDOMCollection("Week Trendings",f.results,"movie",q.Collection.TRENDING,void 0,I.templateCollection.content),L=I.view.children[0];L.insertAdjacentElement("beforebegin",h),L.remove()}),p.API.getPopular("movie","1").then(function(f){if(console.info("getPopular movie",f),f?.results===void 0||f.results.length===0)throw Error("API.getDiscover does not have data");var h=q.Collection.createDOMCollection("Popular Movies",f.results,"movie",q.Collection.POPULAR,void 0,I.templateCollection.content),L=I.view.children[1];L.insertAdjacentElement("beforebegin",h),L.remove()}),p.API.getTopRated("movie","1").then(function(f){if(console.info("getTopRate movie",f),f?.results===void 0||f.results.length===0)throw Error("API.getTopRated does not have data");var h=q.Collection.createDOMCollection("Top Rated Movies",f.results,"movie",q.Collection.TOP_RATED,void 0,I.templateCollection.content),L=I.view.children[2];L.insertAdjacentElement("beforebegin",h),L.remove()}),B.then(function(f){if(f===void 0||f.genres===void 0||f.genres.length===0)throw Error("API.getGenre does not have data");w.genres=f.genres,w.len=f.genres.length,p.Utils.randomPermutation(w.genres),Q(I,4,!1)})});
